<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="è¿™æ˜¯æˆ‘åœ¨2020å¹´6æœˆ26æ—¥~7æœˆ1æ—¥å®Œæˆçš„Bomb Labçš„é¢˜è§£ä¸ç¬”è®° ç‚¸å¼¹å®éªŒå®¤æ˜¯CS:APP é…å¥—å®éªŒä¸­çš„ç¬¬äºŒä¸ªå®éªŒ, é€šè¿‡å¯¹äºŒè¿›åˆ¶æ–‡ä»¶åæ±‡ç¼–æ¥åˆ†æè·å¾—æ‹†é™¤ç‚¸å¼¹çš„å¯†ç . æœ¬æ–‡æ˜¾å¼åœ°åŒ…å«ç­”æ¡ˆ, å¦‚æœä½ æƒ³è‡ªå·±è§£å†³,ä¸å»ºè®®ä½¿ç”¨æœ¬æ–‡.">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP-Labç¬”è®°2:Bomb">
<meta property="og:url" content="http://yoursite.com/2020/07/01/CSAPP-Lab%E7%AC%94%E8%AE%B02-Bomb/index.html">
<meta property="og:site_name" content="(ï¾Ÿâˆ€ã€‚)">
<meta property="og:description" content="è¿™æ˜¯æˆ‘åœ¨2020å¹´6æœˆ26æ—¥~7æœˆ1æ—¥å®Œæˆçš„Bomb Labçš„é¢˜è§£ä¸ç¬”è®° ç‚¸å¼¹å®éªŒå®¤æ˜¯CS:APP é…å¥—å®éªŒä¸­çš„ç¬¬äºŒä¸ªå®éªŒ, é€šè¿‡å¯¹äºŒè¿›åˆ¶æ–‡ä»¶åæ±‡ç¼–æ¥åˆ†æè·å¾—æ‹†é™¤ç‚¸å¼¹çš„å¯†ç . æœ¬æ–‡æ˜¾å¼åœ°åŒ…å«ç­”æ¡ˆ, å¦‚æœä½ æƒ³è‡ªå·±è§£å†³,ä¸å»ºè®®ä½¿ç”¨æœ¬æ–‡.">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-07-01T05:58:10.000Z">
<meta property="article:modified_time" content="2020-07-01T06:06:32.323Z">
<meta property="article:author" content="LUY">
<meta property="article:tag" content="å­¦ä¹ ç¬”è®°">
<meta property="article:tag" content="CSAPP">
<meta property="article:tag" content="Lab">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/07/01/CSAPP-Lab%E7%AC%94%E8%AE%B02-Bomb/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>CSAPP-Labç¬”è®°2:Bomb | (ï¾Ÿâˆ€ã€‚)</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="(ï¾Ÿâˆ€ã€‚)" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">(ï¾Ÿâˆ€ã€‚)</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/01/CSAPP-Lab%E7%AC%94%E8%AE%B02-Bomb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="LUY">
      <meta itemprop="description" content="å˜¿, è¿™é‡Œæ˜¯ç§äººç©ºé—´!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="(ï¾Ÿâˆ€ã€‚)">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CSAPP-Labç¬”è®°2:Bomb
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-01 13:58:10 / ä¿®æ”¹æ—¶é—´ï¼š14:06:32" itemprop="dateCreated datePublished" datetime="2020-07-01T13:58:10+08:00">2020-07-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ ç¬”è®°</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B9%98%E9%BE%99%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">ä¹˜é¾™æœ¯</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B9%98%E9%BE%99%E6%9C%AF/CSAPP/" itemprop="url" rel="index"><span itemprop="name">CSAPP</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>31k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>52 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>è¿™æ˜¯æˆ‘åœ¨2020å¹´6æœˆ26æ—¥~7æœˆ1æ—¥å®Œæˆçš„Bomb Labçš„é¢˜è§£ä¸ç¬”è®°</p>
<p>ç‚¸å¼¹å®éªŒå®¤æ˜¯CS:APP é…å¥—å®éªŒä¸­çš„ç¬¬äºŒä¸ªå®éªŒ, é€šè¿‡å¯¹äºŒè¿›åˆ¶æ–‡ä»¶åæ±‡ç¼–æ¥åˆ†æè·å¾—æ‹†é™¤ç‚¸å¼¹çš„å¯†ç .</p>
<p>æœ¬æ–‡æ˜¾å¼åœ°åŒ…å«ç­”æ¡ˆ, å¦‚æœä½ æƒ³è‡ªå·±è§£å†³,ä¸å»ºè®®ä½¿ç”¨æœ¬æ–‡.</p>
<a id="more"></a>
<h2 id="Catalog"><a href="#Catalog" class="headerlink" title="Catalog"></a>Catalog</h2><ol>
<li>GDB    åŒ…æ‹¬GDBåŸºæœ¬ä½¿ç”¨æ³•, ä½†ä¸å…¨é¢</li>
<li>Bombs  åŒ…æ‹¬å„ç‚¸å¼¹çš„é¢˜è§£ä¸ç­”æ¡ˆ</li>
<li>Functions    åŒ…æ‹¬å„å‡½æ•°åŠå…¶å—è°ƒç”¨å‡½æ•°çš„åæ±‡ç¼–,åŠè§£é‡Š</li>
</ol>
<h2 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h2><h3 id="Breakpoints"><a href="#Breakpoints" class="headerlink" title="Breakpoints"></a>Breakpoints</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">break sum					è¿›å…¥sum()æ—¶æ–­ç‚¹</span><br><span class="line">break *0x80483c3 			åœ¨åœ°å€ 0x80483c3 è®¾ç½®æ–­ç‚¹(æ³¨æ„&#96;\*å·)</span><br></pre></td></tr></table></figure>
<h3 id="Execution"><a href="#Execution" class="headerlink" title="Execution"></a>Execution</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stepi n						æ‰§è¡Œnæ¡æŒ‡ä»¤,ç¼ºçœä¸º1 ä¼šè¿›å…¥è¢«è°ƒç”¨å‡½æ•°</span><br><span class="line">nexti n						æ‰§è¡Œnæ¡æŒ‡ä»¤,ç¼ºçœä¸º1 ä¸ä¼šè¿›å…¥è¢«è°ƒç”¨å‡½æ•°</span><br></pre></td></tr></table></figure>
<h3 id="Print"><a href="#Print" class="headerlink" title="Print"></a>Print</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print (char *) 0xbfff890   	Examine a string stored at 0xbffff890</span><br><span class="line"></span><br><span class="line">print  &#x2F;x $rip         		åå…­è¿›åˆ¶æ‰“å°ripå¯„å­˜å™¨ (&#x2F;xå¯æ¢ä¸º&#x2F;dæˆ–&#x2F;b)</span><br><span class="line"></span><br><span class="line">print *(int *) 0xbffff890 	Print integer at address 0xbffff890</span><br><span class="line"></span><br><span class="line">print *(int **) ($rsp+8)	Print address at address  ($rsp+8)</span><br></pre></td></tr></table></figure>
<h3 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> info registers     	Print all registers and their contents </span><br><span class="line"></span><br><span class="line">info breakpoints  		Print status of user-settable breakpoints</span><br></pre></td></tr></table></figure>
<h2 id="Bombs"><a href="#Bombs" class="headerlink" title="Bombs"></a>Bombs</h2><h3 id="Bomb1"><a href="#Bomb1" class="headerlink" title="Bomb1"></a>Bomb1</h3><p>ç‚¸å¼¹1æ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>Phase_1</li>
<li>strings_not_equal</li>
<li>string_length</li>
</ol>
<p>è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸², å®ƒå°†ä¸ä½äºåœ°å€<code>0x402400</code>çš„å­—ç¬¦ä¸²æ¯”è¾ƒ, ç›¸ç¬¦å³å¯æ‹†é™¤.</p>
<p>å› æ­¤ç­”æ¡ˆä¸º:</p>
<blockquote>
<p>Border relations with Canada have never been better.</p>
</blockquote>
<h3 id="Bomb2"><a href="#Bomb2" class="headerlink" title="Bomb2"></a>Bomb2</h3><p>ç‚¸å¼¹2æ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>Phase_2</li>
<li>read_six_numbers</li>
</ol>
<p>è¾“å…¥6ä¸ªæ•°å­—, ç¬¬ä¸€ä¸ªæ˜¯1, å‰©ä¸‹æˆå…¬æ¯”ä¸º2çš„G.P. å³å¯æ‹†é™¤.</p>
<p>å› æ­¤ç­”æ¡ˆä¸º:</p>
<blockquote>
<p>1 2 4 8 16 32</p>
</blockquote>
<h3 id="Bomb3"><a href="#Bomb3" class="headerlink" title="Bomb3"></a>Bomb3</h3><p>ç‚¸å¼¹3æ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>phase_3</li>
<li>__isoc99_sscanf</li>
</ol>
<p>è¾“å…¥ä¸¤ä¸ªæ•°å­—, è¿™ä¸¤ä¸ªæ•°å­—å¿…é¡»æ˜¯ä»¥ä¸‹8ç»„ä¹‹ä¸€:</p>
<ul>
<li>0    207</li>
<li>1    311</li>
<li>2    707</li>
<li>3    256</li>
<li>4    389</li>
<li>5    206</li>
<li>6    682</li>
<li>7    327</li>
</ul>
<p>ä¾‹å¦‚,ç­”æ¡ˆå¯ä»¥è¾“å…¥:</p>
<blockquote>
<p>2   707</p>
</blockquote>
<p>ç­”æ¡ˆä¸å”¯ä¸€</p>
<h3 id="Bomb4"><a href="#Bomb4" class="headerlink" title="Bomb4"></a>Bomb4</h3><p>è¿™ä¸ªé€’å½’ç‚¸å¼¹çœŸæŠŠæˆ‘æ•´ğŸ¤®äº†â€¦ æ¯ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤éƒ½èƒ½çœ‹æ‡‚åœ¨å¹²ä»€ä¹ˆ, åˆåœ¨ä¸€èµ·å°±å‚»äº†, è¿çŒœå¸¦è’™æŠŠç­”æ¡ˆé¼“æ£å‡ºæ¥äº†â€¦</p>
<p>æˆ‘è®¨åŒé€’å½’ğŸ˜­</p>
<p>PS: åæ¥ç”¨åæ±‡ç¼–è§£å†³äº†</p>
<p>ç‚¸å¼¹4æ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>phase_4</li>
<li>func4</li>
</ol>
<p>è¾“å…¥ä¸¤ä¸ªæ•°å­—, æ•°å­—1å¿…é¡»ä¸º <code>{0,1,3,7}</code> ä¸­ä»»ä¸€ä¸ª, æ•°å­—2å¿…é¡»ä¸º <code>0</code>.</p>
<p>ä¾‹å¦‚, ç­”æ¡ˆå¯ä»¥è¾“å…¥:</p>
<blockquote>
<p>3  0</p>
</blockquote>
<p>ç­”æ¡ˆä¸å”¯ä¸€</p>
<h3 id="Bomb-5"><a href="#Bomb-5" class="headerlink" title="Bomb 5"></a>Bomb 5</h3><p>ç›¸å¯¹ä¸éš¾çš„æ˜ å°„ç‚¸å¼¹, å°†è¾“å…¥çš„å­—ç¬¦è¿›è¡Œè¿ç®—æ˜ å°„åˆ°ç‰¹å®šåœ°å€, å¹¶æ ¹æ®è¿™äº›åœ°å€ä¸­å–å‡ºçš„å­—ç¬¦åˆ¤æ–­æ˜¯å¦çˆ†ç‚¸.</p>
<p>ç‚¸å¼¹5æ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>phase_5</li>
<li>strings_not_equal</li>
<li>string_length</li>
</ol>
<p>è¾“å…¥é•¿åº¦ä¸º6çš„å­—ç¬¦ä¸², æ¯ä¸ªå­—ç¬¦éƒ½è¦ç¬¦åˆä»¥ä¸‹æ¡ä»¶:</p>
<ol>
<li>ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?9</code></li>
<li>ç¬¬äºŒä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?f</code></li>
<li>ç¬¬ä¸‰ä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?e</code></li>
<li>ç¬¬å››ä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?5</code></li>
<li>ç¬¬äº”ä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?6</code></li>
<li>ç¬¬å…­ä¸ªå­—ç¬¦çš„ASCIIç å¿…é¡»æ˜¯<code>0x?7</code></li>
</ol>
<p>å…¶ä¸­,<code>?</code>è¡¨ç¤ºä»»æ„æ•°å­—, ä¾‹å¦‚:</p>
<ol>
<li><p><code>?</code>å…¨éƒ¨å–4 . åº”è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º:</p>
<blockquote>
<p>IONEFG</p>
</blockquote>
</li>
<li><p><code>?</code>å…¨éƒ¨å–3 . åº”è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º:</p>
<blockquote>
<p>9?&gt;567</p>
</blockquote>
</li>
<li><p><code>?</code>ä¹Ÿä¸ä¸€å®šåªå–åŒä¸€ä¸ªå€¼, ä¾‹å¦‚ç¬¬12,34,56å­—ç¬¦çš„<code>?</code>å€¼åˆ†åˆ«å–3,4,6. åº”è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º:</p>
<blockquote>
<p>9?NEfg</p>
</blockquote>
</li>
</ol>
<p>ä¸Šè¿°å­—ç¬¦ä¸²å‡å¯ä½œä¸ºç­”æ¡ˆ, ç­”æ¡ˆä¸å”¯ä¸€.</p>
<h3 id="Bomb-6"><a href="#Bomb-6" class="headerlink" title="Bomb 6"></a>Bomb 6</h3><p>æ¯”è¾ƒçƒ¦çš„å¾ªç¯ç‚¸å¼¹, ä¸€å…±æ¶‰åŠåˆ°äº†6ä¸ªå¾ªç¯(è¿˜åŒ…æ‹¬ä¸€ä¸ªåµŒå¥—å¾ªç¯) ,ä¸€ç‚¹ç‚¹æ‹å¼€å°±å¥½äº†.è¦æ±‚è¾“å…¥å…­ä¸ªä¸åŒæ•°å­—, æ¯ä¸ªæ•°å­—éƒ½å¿…é¡»åœ¨1-6ä¹‹é—´,å¹¶ä¸”æ•°å­—éœ€è¦æŒ‰ç…§å›ºå®šé¡ºåº</p>
<p>ç‚¸å¼¹6æ¶‰åŠä»¥ä¸‹å‡½æ•°:</p>
<ol>
<li>phase_6</li>
<li>read_six_numbers</li>
</ol>
<p>è¾“å…¥çš„æ¯ä¸ªæ•°å­—æœ€åéƒ½ä¼šæ˜ å°„åˆ°ä¸€ä¸ªä¸‰ä½æ•°ä¸Š, è¦æ±‚è¢«æ˜ å°„é¡ºåºå¿…é¡»ä½¿ç”±å¤§åˆ°å°, å› æ­¤è¾“å…¥çš„æ•°å­—å¿…é¡»æŒ‰ç…§å›ºå®šé¡ºåº. </p>
<p>ç­”æ¡ˆ:</p>
<blockquote>
<p>4,3,2,1,6,5</p>
</blockquote>
<h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><h3 id="Main"><a href="#Main" class="headerlink" title="Main()"></a>Main()</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *input;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è¯»å…¥æ•°æ® */</span></span><br><span class="line">    <span class="keyword">if</span> (argc == <span class="number">1</span>) &#123;  </span><br><span class="line">		infile = <span class="built_in">stdin</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (argc == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(infile = fopen(argv[<span class="number">1</span>], <span class="string">"r"</span>))) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%s: Error: Couldn't open %s\n"</span>, argv[<span class="number">0</span>], argv[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Usage: %s [&lt;input_file&gt;]\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å¼€å§‹ç‚¸å¼¹ */</span></span><br><span class="line">    initialize_bomb();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Welcome to my fiendish little bomb. You have 6 phases with\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"which to blow yourself up. Have a nice day!\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Bomb1 */</span></span><br><span class="line">    input = read_line();          </span><br><span class="line">    phase_1(input);               </span><br><span class="line">    phase_defused();                 </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Phase 1 defused. How about the next one?\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Bomb2 */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_2(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"That's number 2.  Keep going!\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Bomb3 */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_3(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Halfway there!\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Bomb4 */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_4(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"So you got that one.  Try this one.\n"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Bomb5 */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_5(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Good work!  On to the next...\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Bomb6 */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_6(input);</span><br><span class="line">    phase_defused();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ç»“æŸ */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Phase-1"><a href="#Phase-1" class="headerlink" title="Phase_1"></a>Phase_1</h3><ul>
<li>è¾“å…¥: ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆ input</li>
<li>åŠŸèƒ½: input æŒ‡å‘å¯¹è±¡ä¸ åœ°å€<code>$0x402400</code>æŒ‡å‘å¯¹è±¡ç›¸åŒ,ä¸åŒç‚¸</li>
<li>è°ƒç”¨: strings_not_equal();  </li>
<li>è¿”å›: 0</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_1:</span><br><span class="line">&#x2F;&#x2F;rdi &#x3D; *input</span><br><span class="line">    0x0000000000400ee0 &lt;+0&gt;:	sub    $0x8,%rsp        &#x2F;&#x2F;æ ˆä¸‹è°ƒ8ä½</span><br><span class="line">    0x0000000000400ee4 &lt;+4&gt;:	mov    $0x402400,%esi   &#x2F;&#x2F;$0x402400 æ”¾å…¥%esi(å‚æ•°2)</span><br><span class="line">    0x0000000000400ee9 &lt;+9&gt;:	callq  0x401338 &lt;strings_not_equal&gt; &#x2F;&#x2F;è°ƒç”¨strings_not_equal</span><br><span class="line">    0x0000000000400eee &lt;+14&gt;:	test   %eax,%eax       &#x2F;&#x2F;æ£€æµ‹å‚1å‚2æ˜¯å¦ç›¸åŒ</span><br><span class="line">    0x0000000000400ef0 &lt;+16&gt;:	je     0x400ef7 &lt;phase_1+23&gt;    &#x2F;&#x2F;0ç›¸åŒ è½¬+23</span><br><span class="line">    0x0000000000400ef2 &lt;+18&gt;:	callq  0x40143a &lt;explode_bomb&gt;  &#x2F;&#x2F;1ä¸åŒ,ç‚¸</span><br><span class="line">    0x0000000000400ef7 &lt;+23&gt;:	add    $0x8,%rsp    &#x2F;&#x2F;å‡ºæ ˆ</span><br><span class="line">    0x0000000000400efb &lt;+27&gt;:	retq</span><br></pre></td></tr></table></figure>
<h3 id="strings-not-equal"><a href="#strings-not-equal" class="headerlink" title="strings_not_equal"></a>strings_not_equal</h3><ul>
<li>è¾“å…¥: å‚æ•°12 å‡ä¸ºå­—ç¬¦åœ°å€</li>
<li>åŠŸèƒ½: æ¯”è¾ƒä¸¤ä¸ªæŒ‡å‘å¯¹è±¡é•¿åº¦ä¸å†…å®¹æ˜¯å¦ç›¸åŒ</li>
<li>è°ƒç”¨: string_length()</li>
<li>è¿”å›: ç›¸åŒè¿”å›0, ä¸åŒè¿”å›1</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function strings_not_equal:</span><br><span class="line">&#x2F;* rdi &#x3D; *input; esi &#x3D; $0x402400</span><br><span class="line">    0x0000000000401338 &lt;+0&gt;:	push   %r12</span><br><span class="line">    0x000000000040133a &lt;+2&gt;:	push   %rbp</span><br><span class="line">    0x000000000040133b &lt;+3&gt;:	push   %rbx     &#x2F;&#x2F;ä»¥ä¸Šä¿å­˜ç¯å¢ƒ</span><br><span class="line">    0x000000000040133c &lt;+4&gt;:	mov    %rdi,%rbx    &#x2F;&#x2F;rbx &#x3D; *input</span><br><span class="line">    0x000000000040133f &lt;+7&gt;:	mov    %rsi,%rbp    &#x2F;&#x2F;rbp &#x3D; $0x402400(åœ°å€)</span><br><span class="line">    0x0000000000401342 &lt;+10&gt;:	callq  0x40131b &lt;string_length&gt; &#x2F;&#x2F;è°ƒç”¨string_length, å‚æ•°ä¸å˜</span><br><span class="line">    0x0000000000401347 &lt;+15&gt;:	mov    %eax,%r12d   &#x2F;&#x2F;r12d(åŒå­—)ä¿å­˜å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line">    0x000000000040134a &lt;+18&gt;:	mov    %rbp,%rdi    &#x2F;&#x2F;è®¡ç®—($0x402400)çš„é•¿åº¦</span><br><span class="line">    0x000000000040134d &lt;+21&gt;:	callq  0x40131b &lt;string_length&gt; &#x2F;&#x2F;($0x402400)é•¿åº¦ä¿å­˜åœ¨rax</span><br><span class="line">    0x0000000000401352 &lt;+26&gt;:	mov    $0x1,%edx    &#x2F;&#x2F;edx &#x3D; 1</span><br><span class="line">    0x0000000000401357 &lt;+31&gt;:	cmp    %eax,%r12d   &#x2F;&#x2F;å­—ç¬¦ä¸²ä¸å¸¸æ•°é•¿åº¦æ¯”è¾ƒ</span><br><span class="line">    0x000000000040135a &lt;+34&gt;:	jne    0x40139b &lt;strings_not_equal+99&gt;  &#x2F;&#x2F;é•¿åº¦ä¸åŒè½¬99</span><br><span class="line">    0x000000000040135c &lt;+36&gt;:	movzbl (%rbx),%eax  &#x2F;&#x2F;ä¸²1 -&gt; rax</span><br><span class="line">    0x000000000040135f &lt;+39&gt;:	test   %al,%al</span><br><span class="line">    0x0000000000401361 &lt;+41&gt;:	je     0x401388 &lt;strings_not_equal+80&gt;&#x2F;&#x2F;å¦‚æœä¸²1ç©º,è½¬80</span><br><span class="line">    0x0000000000401363 &lt;+43&gt;:	cmp    0x0(%rbp),%al        &#x2F;&#x2F;æ¯”è¾ƒä¸²1ä¸²2</span><br><span class="line">    0x0000000000401366 &lt;+46&gt;:	je     0x401372 &lt;strings_not_equal+58&gt;  &#x2F;&#x2F;ç›¸ç­‰,è½¬58</span><br><span class="line">    0x0000000000401368 &lt;+48&gt;:	jmp    0x40138f &lt;strings_not_equal+87&gt;  &#x2F;&#x2F;ä¸ç­‰,è½¬87</span><br><span class="line">    0x000000000040136a &lt;+50&gt;:	cmp    0x0(%rbp),%al    &#x2F;&#x2F;æ¯”è¾ƒ(å¸¸æ•°)ä¸å­—ç¬¦ä¸²</span><br><span class="line">    0x000000000040136d &lt;+53&gt;:	nopl   (%rax)       &#x2F;&#x2F;å¥½åƒæ˜¯å¯¹é½ç”¨çš„? æ— æ“ä½œ</span><br><span class="line">    0x0000000000401370 &lt;+56&gt;:	jne    0x401396 &lt;strings_not_equal+94&gt;  &#x2F;&#x2F;ä¸ç­‰è½¬94</span><br><span class="line">    0x0000000000401372 &lt;+58&gt;:	add    $0x1,%rbx    &#x2F;&#x2F;å­—ç¬¦ä¸²æŒ‡é’ˆ++</span><br><span class="line">    0x0000000000401376 &lt;+62&gt;:	add    $0x1,%rbp    &#x2F;&#x2F;å¸¸æ•°åœ°å€æŒ‡é’ˆ++</span><br><span class="line">    0x000000000040137a &lt;+66&gt;:	movzbl (%rbx),%eax  </span><br><span class="line">    0x000000000040137d &lt;+69&gt;:	test   %al,%al      &#x2F;&#x2F;å¦‚æœå­—ç¬¦ä¸²ä¸ç©º</span><br><span class="line">    0x000000000040137f &lt;+71&gt;:	jne    0x40136a &lt;strings_not_equal+50&gt; &#x2F;&#x2F;è½¬+50</span><br><span class="line">    0x0000000000401381 &lt;+73&gt;:	mov    $0x0,%edx	&#x2F;&#x2F;å¦‚æœä¸²1ç©º</span><br><span class="line">    0x0000000000401386 &lt;+78&gt;:	jmp    0x40139b &lt;strings_not_equal+99&gt;</span><br><span class="line">    0x0000000000401388 &lt;+80&gt;:	mov    $0x0,%edx	&#x2F;&#x2F;ä¸Šæ¥41,ä¸²1ç©º, è¿”å›0</span><br><span class="line">    0x000000000040138d &lt;+85&gt;:	jmp    0x40139b &lt;strings_not_equal+99&gt;</span><br><span class="line">    0x000000000040138f &lt;+87&gt;:	mov    $0x1,%edx    &#x2F;&#x2F;ä¸Šæ¥48,ä¸²12ä¸ç­‰,è¿”å›1</span><br><span class="line">    0x0000000000401394 &lt;+92&gt;:	jmp    0x40139b &lt;strings_not_equal+99&gt;</span><br><span class="line">    0x0000000000401396 &lt;+94&gt;:	mov    $0x1,%edx    &#x2F;&#x2F;ä¸Šæ¥94,ä¸²ä¸ç­‰,è¿”å›1</span><br><span class="line">    0x000000000040139b &lt;+99&gt;:	mov    %edx,%eax    &#x2F;&#x2F;ä¸Šæ¥34,é•¿åº¦ä¸ç­‰,è¿”å›1</span><br><span class="line">    0x000000000040139d &lt;+101&gt;:	pop    %rbx </span><br><span class="line">    0x000000000040139e &lt;+102&gt;:	pop    %rbp</span><br><span class="line">    0x000000000040139f &lt;+103&gt;:	pop    %r12 &#x2F;&#x2F;æ¢å¤ç¯å¢ƒ</span><br><span class="line">    0x00000000004013a1 &lt;+105&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>æ³¨:</p>
<ol>
<li><p>å¼€å¤´ç»“å°¾æœ‰ä¿å­˜ç¯å¢ƒçš„pushä¸popæ“ä½œ</p>
</li>
<li><p>r12d æŒ‡12å¯„å­˜å™¨çš„åŒå­—éƒ¨åˆ†, ä¾æ¬¡æ˜¯:r12, r12d, r12w, r12b. dç–‘ä¼¼æŒ‡double word</p>
</li>
<li><p>nopl ä¸ºæ— æ“ä½œ, å¯å‚è€ƒ<a href="https://exp.newsmth.net/topic/article/9a37ce02c405b2b7ae9558f161f38c38" target="_blank" rel="noopener">è¿™é‡Œ</a>.</p>
</li>
<li><p>è¿‡ç¨‹:</p>
<ol>
<li>å…ˆæ¯”è¾ƒä¸¤ä¸²çš„é•¿åº¦,è‹¥ä¸åŒç›´æ¥è¿”å›1(+34); </li>
<li>ç„¶åä¸€ä¸ªä¸€ä¸ªbitåœ°æ¯”è¾ƒ, æ¯æ¬¡æ¯”è¾ƒå®Œè·³è½¬å›+50, ç›´åˆ°å…¨éƒ¨æ¯”è¾ƒç»“æŸ, ä¸²ä¸ºç©º,è¿”å›0</li>
<li>å½“æ¯”è¾ƒä¸­é‡åˆ°ä¸²ä¸ç­‰, ç«‹åˆ»é€€å‡º,è¿”å›1</li>
</ol>
</li>
<li><p>ç–‘æƒ‘:</p>
<ol>
<li><p>ä¸ºä»€ä¹ˆæ¯æ¬¡æŒ‡é’ˆä»…ä»…æ˜¯è‡ªåŠ ? æ¯æ¬¡æ˜¯å¯¹alæ¯”è¾ƒ(1byte), æŒ‡é’ˆ+4å²‚ä¸ç¾å“‰?</p>
</li>
<li><p>87,94,99éƒ½æ˜¯å‡ºé”™, è¿”å›1, ä¸ºä»€ä¹ˆä¸åˆå¹¶æˆ1ä¸ª? </p>
<p>(çŒœæµ‹:å¯èƒ½æ˜¯ä¼˜åŒ–çº§åˆ«ä¸å¤Ÿ, ç…§é¡¾æˆ‘ä»¬çš„æ™ºåŠ›æ°´å¹³ğŸ˜‚)</p>
</li>
</ol>
</li>
</ol>
<h3 id="string-length"><a href="#string-length" class="headerlink" title="string_length"></a>string_length</h3><ul>
<li>è¾“å…¥: å­—ç¬¦æŒ‡é’ˆ</li>
<li>åŠŸèƒ½: è¿”å›æŒ‡å‘çš„ä¸²çš„é•¿åº¦, ç©ºè¿”å›0</li>
<li>æ— è°ƒç”¨</li>
<li>è¿”å›: è¿”å›æŒ‡å‘çš„ä¸²çš„é•¿åº¦, ç©ºè¿”å›0</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rdi &#x3D; *input; </span><br><span class="line">Dump of assembler code for function string_length:</span><br><span class="line">    0x000000000040131b &lt;+0&gt;:	cmpb   $0x0,(%rdi)      </span><br><span class="line">    0x000000000040131e &lt;+3&gt;:	je     0x401332 &lt;string_length+23&gt;  &#x2F;&#x2F;å¦‚æœinputç©º, è½¬23(è¿”å›0)</span><br><span class="line">    0x0000000000401320 &lt;+5&gt;:	mov    %rdi,%rdx        &#x2F;&#x2F;rdx &#x3D; *input</span><br><span class="line">    0x0000000000401323 &lt;+8&gt;:	add    $0x1,%rdx        &#x2F;&#x2F;rdx ++ æ¯è½®å°†æŒ‡é’ˆ+1 </span><br><span class="line">    0x0000000000401327 &lt;+12&gt;:	mov    %edx,%eax    &#x2F;&#x2F;eax &#x3D;rdx</span><br><span class="line">    0x0000000000401329 &lt;+14&gt;:	sub    %edi,%eax    &#x2F;&#x2F;eax -&#x3D; edi, å½“å‰æŒ‡é’ˆä¸åŸæŒ‡é’ˆå·®å€¼</span><br><span class="line">    0x000000000040132b &lt;+16&gt;:	cmpb   $0x0,(%rdx)  &#x2F;&#x2F;æŒ‡é’ˆæŒ‡å‘ä¸0æ¯”è¾ƒ</span><br><span class="line">    0x000000000040132e &lt;+19&gt;:	jne    0x401323 &lt;string_length+8&gt;&#x2F;&#x2F;å½“æŒ‡å‘éé›¶, è¡¨ç¤ºè¿˜æœªç»“æŸ é€’å½’è°ƒç”¨</span><br><span class="line">    0x0000000000401330 &lt;+21&gt;:	repz retq   &#x2F;&#x2F;è¿”è¿˜rax å³æœ€åçš„å·®å€¼, ä¸ºæŒ‡é’ˆå‚¨å­˜çš„æ•°æ®çš„é•¿åº¦</span><br><span class="line">    0x0000000000401332 &lt;+23&gt;:	mov    $0x0,%eax    &#x2F;&#x2F;(ä¸Šæ¥+3) è¿”å›0</span><br><span class="line">    0x0000000000401337 &lt;+28&gt;:	retq</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Phase-2"><a href="#Phase-2" class="headerlink" title="Phase_2"></a>Phase_2</h3><ul>
<li>è¾“å…¥: *input</li>
<li>åŠŸèƒ½: ä¸å…­ä¸ªæ•°å­—æ¯”è¾ƒ, ä¸åŒç‚¸</li>
<li>è°ƒç”¨: read_six_numbers</li>
<li>è¿”å›: æ— </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_2:</span><br><span class="line">&#x2F;&#x2F;rdi *input</span><br><span class="line">    0x0000000000400efc &lt;+0&gt;:	push   %rbp</span><br><span class="line">    0x0000000000400efd &lt;+1&gt;:	push   %rbx			&#x2F;&#x2F;ä¿å­˜ç¯å¢ƒ</span><br><span class="line">    0x0000000000400efe &lt;+2&gt;:	sub    $0x28,%rsp   &#x2F;&#x2F;æ ˆåˆ†28ä½</span><br><span class="line">    0x0000000000400f02 &lt;+6&gt;:	mov    %rsp,%rsi    &#x2F;&#x2F;æ ˆæŒ‡é’ˆä½œä¸ºç¬¬äºŒä¸ªå‚æ•°</span><br><span class="line">    0x0000000000400f05 &lt;+9&gt;:	callq  0x40145c &lt;read_six_numbers&gt;	&#x2F;&#x2F;è¯»æ•°åœ¨æ ˆå†…</span><br><span class="line">    0x0000000000400f0a &lt;+14&gt;:	cmpl   $0x1,(%rsp)  &#x2F;&#x2F;æ ˆé¡¶å…ƒç´ ä¸1æ¯”è¾ƒ</span><br><span class="line">    0x0000000000400f0e &lt;+18&gt;:	je     0x400f30 &lt;phase_2+52&gt;    &#x2F;&#x2F;ä¸åŒç‚¸, ç›¸åŒè½¬52</span><br><span class="line">    0x0000000000400f10 &lt;+20&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x0000000000400f15 &lt;+25&gt;:	jmp    0x400f30 &lt;phase_2+52&gt;</span><br><span class="line">    0x0000000000400f17 &lt;+27&gt;:	mov    -0x4(%rbx),%eax      &#x2F;&#x2F;eax &#x3D; æ ˆå…ƒç´ å‰ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    0x0000000000400f1a &lt;+30&gt;:	add    %eax,%eax            &#x2F;&#x2F;eax *&#x3D; 2</span><br><span class="line">    0x0000000000400f1c &lt;+32&gt;:	cmp    %eax,(%rbx)              &#x2F;&#x2F;rbx(ä¸‹ä¸€ä¸ªå…ƒç´ )ä¸eax(ä¸¤å€çš„ä¸Šä¸€ä¸ªå…ƒç´ )æ¯”è¾ƒ</span><br><span class="line">    0x0000000000400f1e &lt;+34&gt;:	je     0x400f25 &lt;phase_2+41&gt;    &#x2F;&#x2F;ä¸åŒç‚¸,ç›¸åŒè½¬41</span><br><span class="line">    0x0000000000400f20 &lt;+36&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x0000000000400f25 &lt;+41&gt;:	add    $0x4,%rbx            &#x2F;&#x2F;rbx &#x3D; æ ˆä¸‹ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    0x0000000000400f29 &lt;+45&gt;:	cmp    %rbp,%rbx            &#x2F;&#x2F;rbx ä¸ rbpæ¯”è¾ƒ</span><br><span class="line">    0x0000000000400f2c &lt;+48&gt;:	jne    0x400f17 &lt;phase_2+27&gt;    &#x2F;&#x2F;ä¸åŒè½¬27,ç»§ç»­è½®å›</span><br><span class="line">    0x0000000000400f2e &lt;+50&gt;:	jmp    0x400f3c &lt;phase_2+64&gt;&#x2F;&#x2F;ç›¸åŒ,ç¬¬å…­ä¸ªå…ƒç´  è½¬64</span><br><span class="line">    0x0000000000400f30 &lt;+52&gt;:	lea    0x4(%rsp),%rbx       &#x2F;&#x2F;rbx &#x3D; ä¸‹ä¸€ä¸ªå…ƒç´ </span><br><span class="line">    0x0000000000400f35 &lt;+57&gt;:	lea    0x18(%rsp),%rbp      &#x2F;&#x2F;rbp &#x3D; æ ˆé¡¶+18(åº”è¯¥æ˜¯ç¬¬å…­ä¸ªå…ƒç´ ,å­˜ç–‘)</span><br><span class="line">    0x0000000000400f3a &lt;+62&gt;:	jmp    0x400f17 &lt;phase_2+27&gt;   &#x2F;&#x2F;è½¬27</span><br><span class="line">    0x0000000000400f3c &lt;+64&gt;:	add    $0x28,%rsp           &#x2F;&#x2F;å‡ºæ ˆ28ä½</span><br><span class="line">    0x0000000000400f40 &lt;+68&gt;:	pop    %rbx</span><br><span class="line">    0x0000000000400f41 &lt;+69&gt;:	pop    %rbp             &#x2F;&#x2F;æ¢å¤ç¯å¢ƒ</span><br><span class="line">    0x0000000000400f42 &lt;+70&gt;:	retq                    &#x2F;&#x2F;ç»“æŸ</span><br></pre></td></tr></table></figure>
<p>æ³¨: </p>
<ol>
<li>read_six_numbers å‡½æ•°å†…å…¶å®æ²¡çœ‹æ‡‚, ç”±åå­—çŒœæµ‹äº†ä¸€æ³¢</li>
<li>lea S DæŒ‡ä»¤, å°†S(ä¸€ä¸ªæœ‰æ•ˆåœ°å€) å¤åˆ¶ç»™D, åç»­å¼•ç”¨(D)ç”¨æ³•ç±»ä¼¼æŒ‡é’ˆ</li>
<li><code>add    $0x4,%rbx</code> æŒ‡é’ˆä¸‹ä¸€ä¸ªå…ƒç´ , æ³¨æ„æ ˆæ˜¯å€’è¿‡æ¥å‚¨å­˜çš„</li>
<li>å­˜ç–‘:<ol>
<li>57 è¡Œ, <code>%rbp</code>åº”è¯¥æ˜¯è¢«èµ‹äº†ç¬¬å…­ä¸ªå‚æ•°çš„å€¼. å¯æ˜¯ä¸ºä»€ä¹ˆæ˜¯+18? ä¸åº”è¯¥æ˜¯+ 20(4*5)å—?</li>
</ol>
</li>
</ol>
<h3 id="read-six-numbers"><a href="#read-six-numbers" class="headerlink" title="read_six_numbers"></a>read_six_numbers</h3><ul>
<li>è¾“å…¥: *input, æ ˆæŒ‡é’ˆ</li>
<li>åŠŸèƒ½: è¯»å–6ä¸ªæ•°æ®å†™åœ¨å†…å­˜ä¸­</li>
<li>è°ƒç”¨: __isoc99_sscanf@plt (ç–‘ä¼¼åº“å‡½æ•°?)</li>
<li>è¿”å›: æ— </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function read_six_numbers:</span><br><span class="line">    0x000000000040145c &lt;+0&gt;:	sub    $0x18,%rsp       &#x2F;&#x2F;åˆ†é…18</span><br><span class="line">    0x0000000000401460 &lt;+4&gt;:	mov    %rsi,%rdx        &#x2F;&#x2F;rdx &#x3D; åŸæ ˆæŒ‡é’ˆ</span><br><span class="line">    0x0000000000401463 &lt;+7&gt;:	lea    0x4(%rsi),%rcx   &#x2F;&#x2F;rcx &#x3D; (æ ˆ4)</span><br><span class="line">    0x0000000000401467 &lt;+11&gt;:	lea    0x14(%rsi),%rax  &#x2F;&#x2F;rax &#x3D; (æ ˆ20)</span><br><span class="line">    0x000000000040146b &lt;+15&gt;:	mov    %rax,0x8(%rsp)   &#x2F;&#x2F;(æ ˆ+8) &#x3D; æ ˆ20</span><br><span class="line">    0x0000000000401470 &lt;+20&gt;:	lea    0x10(%rsi),%rax  &#x2F;&#x2F;rax &#x3D; (æ ˆ+16)</span><br><span class="line">    0x0000000000401474 &lt;+24&gt;:	mov    %rax,(%rsp)      &#x2F;&#x2F;(rsp) &#x3D; rax &#x3D; (åŸæ ˆ+16)</span><br><span class="line">    0x0000000000401478 &lt;+28&gt;:	lea    0xc(%rsi),%r9    &#x2F;&#x2F;r9 &#x3D; (rsi+12)</span><br><span class="line">    0x000000000040147c &lt;+32&gt;:	lea    0x8(%rsi),%r8    &#x2F;&#x2F;r8 &#x3D; (rsi+8)</span><br><span class="line">    0x0000000000401480 &lt;+36&gt;:	mov    $0x4025c3,%esi   &#x2F;&#x2F;si &#x3D; $0x4025c3</span><br><span class="line">    0x0000000000401485 &lt;+41&gt;:	mov    $0x0,%eax        &#x2F;&#x2F;ax &#x3D; 0</span><br><span class="line">    0x000000000040148a &lt;+46&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">    0x000000000040148f &lt;+51&gt;:	cmp    $0x5,%eax        &#x2F;&#x2F;ç»“æœä¸5æ¯”è¾ƒ</span><br><span class="line">    0x0000000000401492 &lt;+54&gt;:	jg     0x401499 &lt;read_six_numbers+61&gt;&#x2F;&#x2F;ç»“æœ&gt;5 ä¸ç‚¸</span><br><span class="line">    0x0000000000401494 &lt;+56&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x0000000000401499 &lt;+61&gt;:	add    $0x18,%rsp       &#x2F;&#x2F;æ”¶å›18</span><br><span class="line">    0x000000000040149d &lt;+65&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>å—¯â€¦è™½ç„¶æˆ‘æ²¡æ‡‚ä»–æ¯ä¸€æ­¥åœ¨å¹²ä»€ä¹ˆ, ä¸å¦¨ç¢æˆ‘çŒœå‡ºä»–æ˜¯ç”¨æ¥å¹²å•¥çš„.</p>
<h3 id="Phase-3"><a href="#Phase-3" class="headerlink" title="Phase_3"></a>Phase_3</h3><ul>
<li>è¾“å…¥: *input</li>
<li>åŠŸèƒ½: ä¸ä¸¤ä¸ªæ•°å­—æ¯”è¾ƒ, ä¸åŒç‚¸</li>
<li>è°ƒç”¨: __isoc99_sscanf</li>
<li>è¿”å›: æ— </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">rdi &#x3D; &amp;input</span><br><span class="line">Dump of assembler code for function phase_3:</span><br><span class="line">    0x0000000000400f43 &lt;+0&gt;:	    sub    $0x18,%rsp               &#x2F;&#x2F;æ ˆæ‰©18</span><br><span class="line">    0x0000000000400f47 &lt;+4&gt;:	    lea    0xc(%rsp),%rcx           &#x2F;&#x2F;rcx &#x3D; &amp;(æ ˆ12)</span><br><span class="line">    0x0000000000400f4c &lt;+9&gt;:	    lea    0x8(%rsp),%rdx           &#x2F;&#x2F;rdx &#x3D; &amp;(æ ˆ8)</span><br><span class="line">    0x0000000000400f51 &lt;+14&gt;:	mov    $0x4025cf,%esi           &#x2F;&#x2F;si &#x3D; $0x4025cf</span><br><span class="line">    0x0000000000400f56 &lt;+19&gt;:	mov    $0x0,%eax                &#x2F;&#x2F;ax &#x3D; $0x0</span><br><span class="line">    0x0000000000400f5b &lt;+24&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;   &#x2F;&#x2F; è§æ³¨è§£p3_1,å°†2ä¸ªæ•°å­—è£…å…¥æ ˆ8 å’Œ æ ˆ12å¤„</span><br><span class="line">    0x0000000000400f60 &lt;+29&gt;:	cmp    $0x1,%eax                &#x2F;&#x2F;axä¸1æ¯”è¾ƒ </span><br><span class="line">    0x0000000000400f63 &lt;+32&gt;:	jg     0x400f6a &lt;phase_3+39&gt;    &#x2F;&#x2F;ax&gt;1 è·³è½¬39 å¦åˆ™ç‚¸</span><br><span class="line">    0x0000000000400f65 &lt;+34&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x0000000000400f6a &lt;+39&gt;:	cmpl   $0x7,0x8(%rsp)           &#x2F;&#x2F;*(æ ˆ8)ä¸7æ¯”è¾ƒ (ä¹Ÿå°±æ˜¯æ•°å­—1ä¸7æ¯”è¾ƒ)</span><br><span class="line">    0x0000000000400f6f &lt;+44&gt;:	ja     0x400fad &lt;phase_3+106&gt;   &#x2F;&#x2F;*(æ ˆ8)&gt;7(æ— ç¬¦å·) è½¬106,ç‚¸</span><br><span class="line">    0x0000000000400f71 &lt;+46&gt;:	mov    0x8(%rsp),%eax           &#x2F;&#x2F;ax &#x3D; *(æ ˆ8) æ•°1</span><br><span class="line">    0x0000000000400f75 &lt;+50&gt;:	jmpq   *0x402470(,%rax,8)       &#x2F;&#x2F;è·³è½¬åˆ°(ax*8+0x402470) è§æ³¨è§£p3_2</span><br><span class="line">    0x0000000000400f7c &lt;+57&gt;:	mov    $0xcf,%eax               &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;0 key &#x3D; 0xcf &#x3D; 207</span><br><span class="line">    0x0000000000400f81 &lt;+62&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400f83 &lt;+64&gt;:	mov    $0x2c3,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;2 key &#x3D; 0x2c3 &#x3D; 707</span><br><span class="line">    0x0000000000400f88 &lt;+69&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400f8a &lt;+71&gt;:	mov    $0x100,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;3 key &#x3D; 0x100 &#x3D; 256</span><br><span class="line">    0x0000000000400f8f &lt;+76&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400f91 &lt;+78&gt;:	mov    $0x185,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;4 key &#x3D; 0x185 &#x3D; 389</span><br><span class="line">    0x0000000000400f96 &lt;+83&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400f98 &lt;+85&gt;:	mov    $0xce,%eax               &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;5 key &#x3D; 0xce  &#x3D; 206</span><br><span class="line">    0x0000000000400f9d &lt;+90&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400f9f &lt;+92&gt;:	mov    $0x2aa,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;6 key &#x3D; 0x2aa &#x3D; 682</span><br><span class="line">    0x0000000000400fa4 &lt;+97&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400fa6 &lt;+99&gt;:	mov    $0x147,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;7 key &#x3D; 0x147 &#x3D; 327</span><br><span class="line">    0x0000000000400fab &lt;+104&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400fad &lt;+106&gt;:	callq  0x40143a &lt;explode_bomb&gt;  &#x2F;&#x2F;ä¸Šæ¥44,è¾“å…¥ä¸ªæ•°&lt;2</span><br><span class="line">    0x0000000000400fb2 &lt;+111&gt;:	mov    $0x0,%eax                &#x2F;&#x2F;è¿™é‡Œæ˜¯ä»€ä¹ˆæƒ…å†µ?å­˜ç–‘</span><br><span class="line">    0x0000000000400fb7 &lt;+116&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">    0x0000000000400fb9 &lt;+118&gt;:	mov    $0x137,%eax              &#x2F;&#x2F;ä¸Šæ¥50 ä¸”ax&#x3D;1 key &#x3D; 0x137 &#x3D; 311</span><br><span class="line">    0x0000000000400fbe &lt;+123&gt;:	cmp    0xc(%rsp),%eax           &#x2F;&#x2F;æ¯”è¾ƒax(å³key)ä¸æ•°2</span><br><span class="line">    0x0000000000400fc2 &lt;+127&gt;:	je     0x400fc9 &lt;phase_3+134&gt;   &#x2F;&#x2F;ä¸ç­‰ç‚¸</span><br><span class="line">    0x0000000000400fc4 &lt;+129&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x0000000000400fc9 &lt;+134&gt;:	add    $0x18,%rsp</span><br><span class="line">    0x0000000000400fcd &lt;+138&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>æ³¨: </p>
<ol>
<li><p>è¾“å…¥ä¸¤ä¸ªæ•°å­—,åˆ†åˆ«å‚¨å­˜åœ¨æ ˆ8ä¸æ ˆ12å¤„, å¤šä½™è¾“å…¥ä¸è®¡</p>
</li>
<li><p>å¦‚æœè¾“å…¥1ä¸ª,ç›´æ¥ç‚¸</p>
</li>
<li><p>æ•°1(æ ˆ8) è‹¥&gt;(unsigned )7, ç›´æ¥ç‚¸</p>
</li>
<li><p>æ ¹æ®æ•°1çš„ä¸åŒå–å€¼(0~7), è·³è½¬åˆ°æ ˆç§å‚¨å­˜çš„ä¸åŒåœ°å€, å¹¶æ ¹æ®åœ°å€æ‹¿åˆ°key(å­˜å‚¨åˆ°axä¸­)</p>
</li>
<li><p>æ•°2(æ ˆ12) ä¸ keyæ¯”è¾ƒ, ä¸åŒç‚¸, ç›¸åŒè¿‡</p>
</li>
<li><p>ç–‘æƒ‘:</p>
<p>+111å¤„æ˜¯ä»€ä¹ˆæ—¶å€™ä¼šè¿è¡Œåˆ°? ç›´æ¥æŠŠaxèµ‹0?</p>
</li>
</ol>
<h4 id="æ³¨è§£p3-1"><a href="#æ³¨è§£p3-1" class="headerlink" title="æ³¨è§£p3_1"></a>æ³¨è§£p3_1</h4><p><strong>__isoc99_sscanf()</strong></p>
<p>â€‹    c99æ ‡å‡†åº“sscanfå‡½æ•°, <a href="http://www.cplusplus.com/reference/cstdio/sscanf/" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p>
<blockquote>
<p>â€‹    int sscanf ( const char <em> s, const char </em> format, â€¦);</p>
<p>â€‹    Read formatted data from string</p>
<p>â€‹    Reads data from s and stores them according to parameter format into the locations given by the additional arguments, as if scanf was used, but reading from s instead of the standard input (stdin).</p>
<p>â€‹    The additional arguments should point to already allocated objects of the type specified by their corresponding format specifier within the format string.</p>
<p>â€‹    Return Value</p>
<p>â€‹    On success, the function returns the number of items in the argument list successfully filled. This count can match the expected number of items or be less (even zero) in the case of a matching failure.</p>
<p>â€‹    In the case of an input failure before any data could be successfully interpreted, EOF is returned. </p>
</blockquote>
<p>â€‹    è¿”å›è¯»å–åˆ°çš„itemçš„ä¸ªæ•°</p>
<h4 id="æ³¨è§£p3-2"><a href="#æ³¨è§£p3-2" class="headerlink" title="æ³¨è§£p3_2"></a>æ³¨è§£p3_2</h4><p><strong>æ¯ä¸ª(ax*8+0x402470)ä¸­å‚¨å­˜çš„åœ°å€</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print *(int**)  (0x402470+8*0)</span><br><span class="line">$11 &#x3D; (int *) 0x400f7c &lt;phase_3+57&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*1)</span><br><span class="line">$12 &#x3D; (int *) 0x400fb9 &lt;phase_3+118&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*2)</span><br><span class="line">$13 &#x3D; (int *) 0x400f83 &lt;phase_3+64&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*3)</span><br><span class="line">$14 &#x3D; (int *) 0x400f8a &lt;phase_3+71&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*4)</span><br><span class="line">$15 &#x3D; (int *) 0x400f91 &lt;phase_3+78&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*5)</span><br><span class="line">$16 &#x3D; (int *) 0x400f98 &lt;phase_3+85&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*6)</span><br><span class="line">$17 &#x3D; (int *) 0x400f9f &lt;phase_3+92&gt;</span><br><span class="line"></span><br><span class="line">(gdb) print *(int**)  (0x402470+8*7)</span><br><span class="line">$18 &#x3D; (int *) 0x400fa6 &lt;phase_3+99&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Phase-4"><a href="#Phase-4" class="headerlink" title="Phase_4"></a>Phase_4</h3><ul>
<li>è¾“å…¥: *input</li>
<li>åŠŸèƒ½: ä¸ä¸¤ä¸ªæ•°å­—æ¯”è¾ƒ, ç›¸åŒåˆ™ç‚¸å¼¹æ‹†é™¤</li>
<li>è°ƒç”¨: __isoc99_sscanf</li>
<li>è¿”å›: æ— </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">%rdi &amp;input</span><br><span class="line">Dump of assembler code for function phase_4:</span><br><span class="line">    0x000000000040100c &lt;+0&gt;:	sub    $0x18,%rsp               &#x2F;&#x2F;æ‰©æ ˆ18</span><br><span class="line">    0x0000000000401010 &lt;+4&gt;:	lea    0xc(%rsp),%rcx           &#x2F;&#x2F;cx æ ˆ12   æ•°2</span><br><span class="line">    0x0000000000401015 &lt;+9&gt;:	lea    0x8(%rsp),%rdx           &#x2F;&#x2F;dx æ ˆ8    æ•°1</span><br><span class="line">    0x000000000040101a &lt;+14&gt;:	mov    $0x4025cf,%esi           &#x2F;&#x2F;si &#x3D; 0x4025cf</span><br><span class="line">    0x000000000040101f &lt;+19&gt;:	mov    $0x0,%eax                &#x2F;&#x2F;ax &#x3D; 0</span><br><span class="line">    0x0000000000401024 &lt;+24&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;   &#x2F;&#x2F;è¯»å–</span><br><span class="line">    0x0000000000401029 &lt;+29&gt;:	cmp    $0x2,%eax                &#x2F;&#x2F;è¯»å…¥2ä¸ªæ•°å­—</span><br><span class="line">    0x000000000040102c &lt;+32&gt;:	jne    0x401035 &lt;phase_4+41&gt;    &#x2F;&#x2F;è¯»å…¥ä¸ªæ•°!&#x3D;2,ç‚¸</span><br><span class="line">    0x000000000040102e &lt;+34&gt;:	cmpl   $0xe,0x8(%rsp)           &#x2F;&#x2F;æ•°1 ä¸ 14æ¯”è¾ƒ</span><br><span class="line">    0x0000000000401033 &lt;+39&gt;:	jbe    0x40103a &lt;phase_4+46&gt;    &#x2F;&#x2F;æ•°1 &lt;&#x3D;14 è½¬46</span><br><span class="line">    0x0000000000401035 &lt;+41&gt;:	callq  0x40143a &lt;explode_bomb&gt;  &#x2F;&#x2F;æ•°1 &gt;14 ç‚¸</span><br><span class="line">    0x000000000040103a &lt;+46&gt;:	mov    $0xe,%edx                &#x2F;&#x2F;14èµ‹ç»™dx</span><br><span class="line">    0x000000000040103f &lt;+51&gt;:	mov    $0x0,%esi                &#x2F;&#x2F;si &#x3D; 0</span><br><span class="line">    0x0000000000401044 &lt;+56&gt;:	mov    0x8(%rsp),%edi           &#x2F;&#x2F;di æ ˆ8    æ•°1</span><br><span class="line">    0x0000000000401048 &lt;+60&gt;:	callq  0x400fce &lt;func4&gt;         </span><br><span class="line">    0x000000000040104d &lt;+65&gt;:	test   %eax,%eax                &#x2F;&#x2F;å¯¹äºè¿”å›å€¼ax</span><br><span class="line">    0x000000000040104f &lt;+67&gt;:	jne    0x401058 &lt;phase_4+76&gt;    &#x2F;&#x2F;ax!&#x3D;0 è½¬76 ç‚¸</span><br><span class="line">    0x0000000000401051 &lt;+69&gt;:	cmpl   $0x0,0xc(%rsp)           &#x2F;&#x2F;æ ˆ12(æ•°2) &#x3D;&#x3D; 0</span><br><span class="line">    0x0000000000401056 &lt;+74&gt;:	je     0x40105d &lt;phase_4+81&gt;    &#x2F;&#x2F;ä¸ç­‰ç‚¸,ç­‰æ‹†</span><br><span class="line">    0x0000000000401058 &lt;+76&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x000000000040105d &lt;+81&gt;:	add    $0x18,%rsp</span><br><span class="line">    0x0000000000401061 &lt;+85&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>æ³¨:</p>
<ol>
<li>è¿™ä¸€å—ä»£ç è¿˜æ˜¯æ¯”è¾ƒå¥½æ‡‚çš„. 0~32ä»inputä¸­å–ä¸¤ä¸ªæ•°å­—æ”¾å…¥æ ˆ8 æ ˆ12 å¤„, å¦‚æœä¸æ˜¯<strong>ä¸¤ä¸ª</strong>æ•°å­—çš„è¯ç›´æ¥ç‚¸</li>
<li>34~67 æ˜¯å¯¹æ•°1 æ£€æµ‹, é¦–å…ˆæ•°1å¿…é¡»&lt;=14, å¦åˆ™ç‚¸. ç„¶åå¯¹æ•°1è°ƒç”¨func4å‡½æ•°, å¦‚æœè¿”å›å€¼!=0ç›´æ¥ç‚¸</li>
<li>69~85 æ˜¯å¯¹æ•°2 æ£€æµ‹, ç®€å•çš„ä»¤äººå‘æŒ‡. ä¸ä¸º0ç‚¸, ä¸º0ç‚¸å¼¹æ‹†é™¤.</li>
</ol>
<h3 id="func4"><a href="#func4" class="headerlink" title="func4"></a>func4</h3><ul>
<li>è¾“å…¥: rdi = æ•°1 rsi = ?   rdx = 0xe</li>
<li>åŠŸèƒ½: å¯¹å‚æ•°è¿›è¡ŒæŸç§ç¥ç§˜æ“ä½œ, è¿”å›æŸä¸ªå€¼</li>
<li>è°ƒç”¨:  func4</li>
<li>è¿”å›: æŸä¸ªint</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€è½®: rdi &#x3D; æ•°1 rsi &#x3D; 0   rdx &#x3D; 0xe </span><br><span class="line">Dump of assembler code for function func4:</span><br><span class="line">   0x0000000000400fce &lt;+0&gt;:	    sub    $0x8,%rsp            &#x2F;&#x2F;æ ˆæ‰©8</span><br><span class="line">   0x0000000000400fd2 &lt;+4&gt;:	    mov    %edx,%eax            &#x2F;&#x2F;ax &#x3D; dx</span><br><span class="line">   0x0000000000400fd4 &lt;+6&gt;:	    sub    %esi,%eax            &#x2F;&#x2F;ax &#x3D; dx-si</span><br><span class="line">   0x0000000000400fd6 &lt;+8&gt;:	    mov    %eax,%ecx            &#x2F;&#x2F;cx &#x3D; dx-si</span><br><span class="line">   0x0000000000400fd8 &lt;+10&gt;:	shr    $0x1f,%ecx           &#x2F;&#x2F;é€»è¾‘å³ç§» cx 31ä½ æ­£0è´Ÿ1</span><br><span class="line">   0x0000000000400fdb &lt;+13&gt;:	add    %ecx,%eax            &#x2F;&#x2F;ax +&#x3D; cx</span><br><span class="line">   0x0000000000400fdd &lt;+15&gt;:	sar    %eax                 &#x2F;&#x2F;ax ç®—æ•°å³ç§»1ä½</span><br><span class="line">   0x0000000000400fdf &lt;+17&gt;:	lea    (%rax,%rsi,1),%ecx   &#x2F;&#x2F;cx &#x3D; si + ax</span><br><span class="line">   0x0000000000400fe2 &lt;+20&gt;:	cmp    %edi,%ecx            &#x2F;&#x2F;cxä¸æ•°1æ¯”è¾ƒ </span><br><span class="line">   0x0000000000400fe4 &lt;+22&gt;:	jle    0x400ff2 &lt;func4+36&gt;  &#x2F;&#x2F;cx&lt;&#x3D;æ•°1, è½¬36</span><br><span class="line">   0x0000000000400fe6 &lt;+24&gt;:	lea    -0x1(%rcx),%edx      &#x2F;&#x2F;cx&gt;æ•°1 dx &#x3D; cx-1</span><br><span class="line">   0x0000000000400fe9 &lt;+27&gt;:	callq  0x400fce &lt;func4&gt;     &#x2F;&#x2F;è°ƒç”¨func4 di&#x3D;æ•°1,si&#x3D;si,dx&#x3D;cx-1</span><br><span class="line">   0x0000000000400fee &lt;+32&gt;:	add    %eax,%eax            &#x2F;&#x2F;è¿”å›å€¼ax*&#x3D;2</span><br><span class="line">   0x0000000000400ff0 &lt;+34&gt;:	jmp    0x401007 &lt;func4+57&gt;  &#x2F;&#x2F;è¿”å›</span><br><span class="line">   0x0000000000400ff2 &lt;+36&gt;:	mov    $0x0,%eax            &#x2F;&#x2F;ä¸Šæ¥22 ax &#x3D; 0</span><br><span class="line">   0x0000000000400ff7 &lt;+41&gt;:	cmp    %edi,%ecx            &#x2F;&#x2F;æ¯”è¾ƒcx æ•°1</span><br><span class="line">   0x0000000000400ff9 &lt;+43&gt;:	jge    0x401007 &lt;func4+57&gt;  &#x2F;&#x2F;cx&gt;&#x3D;æ•°1(ä¹Ÿå°±æ˜¯cx&#x3D;æ•°1) è½¬57 è¿”å› </span><br><span class="line">   0x0000000000400ffb &lt;+45&gt;:	lea    0x1(%rcx),%esi       &#x2F;&#x2F;cx&lt;æ•°1 si &#x3D; cx+1</span><br><span class="line">   0x0000000000400ffe &lt;+48&gt;:	callq  0x400fce &lt;func4&gt;     &#x2F;&#x2F;è°ƒç”¨func4 di&#x3D;æ•°1,si&#x3D;si&#x3D;cx+1,dx&#x3D;dx</span><br><span class="line">   0x0000000000401003 &lt;+53&gt;:	lea    0x1(%rax,%rax,1),%eax    &#x2F;&#x2F;ax&#x3D;2ax+1</span><br><span class="line">   0x0000000000401007 &lt;+57&gt;:	add    $0x8,%rsp            </span><br><span class="line">   0x000000000040100b &lt;+61&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°æŠ˜ç£¨äº†æˆ‘æ•´æ•´24h, æœ€ç»ˆæ²¡å¿ä½å»æœäº†åˆ«äººçš„é¢˜è§£. ä¸‹é¢è¿™ä¸€æ®µå€Ÿé‰´äº†<a href="https://www.jianshu.com/p/33eb51b2024e" target="_blank" rel="noopener">ä¸€ä½ç®€ä¹¦ç½‘å‹çš„è¿™ç¯‡æ–‡ç« </a></p>
<p>å¯¹func4å‡½æ•°è¿›è¡Œåæ±‡ç¼–:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun4</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v2, <span class="keyword">int</span> v3)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*  x = rdi(æ•°1) </span></span><br><span class="line"><span class="comment">        v2 = rsi(åˆå€¼0)</span></span><br><span class="line"><span class="comment">        v3 = rdx(åˆå€¼e)*/</span></span><br><span class="line">    <span class="keyword">int</span> tmp = (v3 - v2) &gt;&gt; <span class="number">21</span>;    		<span class="comment">//é€»è¾‘å³ç§»</span></span><br><span class="line">    <span class="keyword">int</span> re = ((v3 - v2) + tmp) &gt;&gt; <span class="number">1</span>; 	<span class="comment">//ç®—æ•°å³ç§»</span></span><br><span class="line">    tmp = v2 + re;</span><br><span class="line">    <span class="keyword">if</span>(tmp &lt;= x) &#123;</span><br><span class="line">        <span class="keyword">if</span>(tmp&gt;=x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        re = fun4(x,tmp+<span class="number">1</span>,v3);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>*re+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        re = fun4(x,v2,tmp<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * re;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸å¦¨å†å†™ä¸ªæµ‹è¯•å‡½æ•°:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xe</span> ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(fun4(i, <span class="number">0x0</span>, <span class="number">0xe</span>)==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">1</span><br><span class="line">3</span><br><span class="line">7</span><br></pre></td></tr></table></figure>
<p>å½“ä¸”ä»…å½“ x = 0,1,3,7 ä¸­æŸä¸ªå€¼æ—¶,funcä¼šè¿”å›0.</p>
<h3 id="Phase-5"><a href="#Phase-5" class="headerlink" title="Phase_5"></a>Phase_5</h3><ul>
<li>è¾“å…¥: *input</li>
<li>åŠŸèƒ½: æ ¹æ® input æŒ‡å‘å¯¹è±¡æ˜ å°„å¾—å‡ºæ–°å­—ç¬¦ä¸², è‹¥æ–°å­—ç¬¦ä¸²ä¸<code>flyers</code>ç›¸åŒåˆ™ç‚¸å¼¹æ‹†é™¤</li>
<li>è°ƒç”¨: strings_not_equal(); string_length</li>
<li>è¿”å›: 0</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">%rdi &amp;input</span><br><span class="line">Dump of assembler code for function phase_5:</span><br><span class="line">    0x0000000000401062 &lt;+0&gt;:	push   %rbx</span><br><span class="line">    0x0000000000401063 &lt;+1&gt;:	sub    $0x20,%rsp</span><br><span class="line">    0x0000000000401067 &lt;+5&gt;:	mov    %rdi,%rbx            &#x2F;&#x2F;rbx &#x3D; &amp;input</span><br><span class="line">    0x000000000040106a &lt;+8&gt;:	mov    %fs:0x28,%rax        &#x2F;&#x2F;rax &#x3D; &amp;fs+28      è¯¦è§æ³¨è§£p5_1</span><br><span class="line">    0x0000000000401073 &lt;+17&gt;:	mov    %rax,0x18(%rsp)      &#x2F;&#x2F;æ ˆ18å‚¨å­˜&amp;fs+28</span><br><span class="line">    0x0000000000401078 &lt;+22&gt;:	xor    %eax,%eax            &#x2F;&#x2F;è‡ªæˆ‘å¼‚æˆ–, ç­‰ä»·äºaxç½®0</span><br><span class="line">    0x000000000040107a &lt;+24&gt;:	callq  0x40131b &lt;string_length&gt; &#x2F;&#x2F;æ£€æµ‹rdiçš„é•¿åº¦</span><br><span class="line">    0x000000000040107f &lt;+29&gt;:	cmp    $0x6,%eax            </span><br><span class="line">    0x0000000000401082 &lt;+32&gt;:	je     0x4010d2 &lt;phase_5+112&gt;   &#x2F;&#x2F;é•¿åº¦&#x3D;6 è½¬112</span><br><span class="line">    0x0000000000401084 &lt;+34&gt;:	callq  0x40143a &lt;explode_bomb&gt;  &#x2F;&#x2F;é•¿åº¦!&#x3D;6,ç‚¸</span><br><span class="line">    0x0000000000401089 &lt;+39&gt;:	jmp    0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">    0x000000000040108b &lt;+41&gt;:	movzbl (%rbx,%rax,1),%ecx       &#x2F;&#x2F;cx &#x3D; (ax+bx) &#x3D; input[ax]</span><br><span class="line">    0x000000000040108f &lt;+45&gt;:	mov    %cl,(%rsp)               &#x2F;&#x2F;æ ˆ0 &#x3D; cl</span><br><span class="line">    0x0000000000401092 &lt;+48&gt;:	mov    (%rsp),%rdx              &#x2F;&#x2F;dx &#x3D; æ ˆ0</span><br><span class="line">    0x0000000000401096 &lt;+52&gt;:	and    $0xf,%edx                &#x2F;&#x2F;dx^f å–å4ä½</span><br><span class="line">    0x0000000000401099 &lt;+55&gt;:	movzbl 0x4024b0(%rdx),%edx      &#x2F;&#x2F;dx &#x3D; (0x4024b0+dx) è¿™é‡Œæ¯”è¾ƒå¤æ‚,è¯¦è§æ³¨è§£p5_2,p5_3</span><br><span class="line">    0x00000000004010a0 &lt;+62&gt;:	mov    %dl,0x10(%rsp,%rax,1)    &#x2F;&#x2F;æ ˆ10+ax &#x3D; dl </span><br><span class="line">    0x00000000004010a4 &lt;+66&gt;:	add    $0x1,%rax                &#x2F;&#x2F;ax+&#x3D;1</span><br><span class="line">    0x00000000004010a8 &lt;+70&gt;:	cmp    $0x6,%rax                &#x2F;&#x2F;axä¸6æ¯”è¾ƒ</span><br><span class="line">    0x00000000004010ac &lt;+74&gt;:	jne    0x40108b &lt;phase_5+41&gt;    &#x2F;&#x2F;ä¸ä¸º6 ç»§ç»­å¾ªç¯è‡³41</span><br><span class="line">    &#x2F;&#x2F;å¯¹è¾“å…¥çš„æ¯ä¸ªå­—ç¬¦ä¾æ¬¡è¿ç®—,æ ¹æ®è¿ç®—ç»“æœå–å‡ºç‰¹å®šå†…å­˜ä¸­çš„å­—ç¬¦,ä¾æ¬¡å­˜å‚¨åœ¨æ ˆ10~æ ˆ16å¤„</span><br><span class="line">    0x00000000004010ae &lt;+76&gt;:	movb   $0x0,0x16(%rsp)          &#x2F;&#x2F;æ ˆ16&#x3D;0</span><br><span class="line">    0x00000000004010b3 &lt;+81&gt;:	mov    $0x40245e,%esi           &#x2F;&#x2F;si&#x3D;0x40245e</span><br><span class="line">    0x00000000004010b8 &lt;+86&gt;:	lea    0x10(%rsp),%rdi          &#x2F;&#x2F;di&#x3D;æ ˆ10</span><br><span class="line">    0x00000000004010bd &lt;+91&gt;:	callq  0x401338 &lt;strings_not_equal&gt; &#x2F;&#x2F;æ ˆ10ä¸0x40245eæ¯”è¾ƒ</span><br><span class="line">    0x00000000004010c2 &lt;+96&gt;:	test   %eax,%eax                    &#x2F;&#x2F;å¯¹äºax (strings_not_equalçš„è¿”å›å€¼)</span><br><span class="line">    0x00000000004010c4 &lt;+98&gt;:	je     0x4010d9 &lt;phase_5+119&gt;       &#x2F;&#x2F;è¿”å›å€¼1(ä¸åŒ) ç‚¸ ç›¸åŒè½¬119</span><br><span class="line">    0x00000000004010c6 &lt;+100&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">    0x00000000004010cb &lt;+105&gt;:	nopl   0x0(%rax,%rax,1)</span><br><span class="line">    0x00000000004010d0 &lt;+110&gt;:	jmp    0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">    0x00000000004010d2 &lt;+112&gt;:	mov    $0x0,%eax                    &#x2F;&#x2F;axç½®0</span><br><span class="line">    0x00000000004010d7 &lt;+117&gt;:	jmp    0x40108b &lt;phase_5+41&gt;        &#x2F;&#x2F;è½¬41</span><br><span class="line">    0x00000000004010d9 &lt;+119&gt;:	mov    0x18(%rsp),%rax              &#x2F;&#x2F;ax&#x3D;æ ˆ18</span><br><span class="line">    0x00000000004010de &lt;+124&gt;:	xor    %fs:0x28,%rax                &#x2F;&#x2F;æ ˆ18 ä¸fs+28å¼‚æˆ–</span><br><span class="line">    0x00000000004010e7 &lt;+133&gt;:	je     0x4010ee &lt;phase_5+140&gt;       &#x2F;&#x2F;ç›¸åŒ è½¬140 è§£å†³</span><br><span class="line">    0x00000000004010e9 &lt;+135&gt;:	callq  0x400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">    0x00000000004010ee &lt;+140&gt;:	add    $0x20,%rsp</span><br><span class="line">    0x00000000004010f2 &lt;+144&gt;:	pop    %rbx</span><br><span class="line">    0x00000000004010f3 &lt;+145&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>æ³¨:</p>
<ol>
<li>ä»£ç ä¸­+8~+17,+119~+133éƒ¨åˆ†æ¶‰åŠåˆ°äº†å¯¹äºæ®µå¯„å­˜å™¨fsçš„æ“ä½œ, è¿™æ˜¯è¿›è¡Œäº†æ ˆä¿æŠ¤, é¿å…æ ˆçš„ç¼“å†²åŒºæº¢å‡º.æ­¤å¤„å°†é‡‘ä¸é›€å€¼(canary)å­˜å…¥æ ˆ18å¤„, å¹¶å¤‡ä»½åœ¨fsæ®µ,ç»“æŸæ—¶æ¯”è¾ƒcanaryæ˜¯å¦è¢«ä¿®æ”¹, å¹¶è°ƒç”¨æ ˆæ£€æŸ¥å¤±è´¥å‡½æ•°(__stack_chk_fail) . æ›´å¤šå‚è§æ•™æ3.10ç« ç¼“å†²åŒºæº¢å‡ºéƒ¨åˆ†.</li>
<li>24~34 æ£€æµ‹è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦, è‹¥!=6 ç›´æ¥ç‚¸</li>
<li>41~74 å¯¹ä¸²ä¸­çš„å…­ä¸ªå­—ç¬¦ä¾æ¬¡è¿ç®—,æ ¹æ®è¿ç®—ç»“æœå–å‡ºç‰¹å®šå†…å­˜ä¸­çš„æ˜ å°„å­—ç¬¦,ä¾æ¬¡å­˜å‚¨åœ¨æ ˆ10~æ ˆ16å¤„</li>
<li>76~98 æ¯”è¾ƒå–å‡ºæ¥çš„æ˜ å°„å­—ç¬¦æ˜¯å¦ä¸åœ°å€ <code>0x40245e</code>ä¸­çš„å­—ç¬¦ä¸²(flyers)ä¸€è‡´, ç›¸åŒåˆ™ç‚¸å¼¹æ‹†é™¤.</li>
</ol>
<h4 id="æ³¨è§£p5-1"><a href="#æ³¨è§£p5-1" class="headerlink" title="æ³¨è§£p5_1"></a>æ³¨è§£p5_1</h4><p>â€‹    fsæ®µå¯„å­˜å™¨</p>
<p>â€‹    8086CPUå°†å†…å­˜åˆ†æ®µï¼Œå¹¶è®¾è®¡äº† 4 ä¸ªæ®µå¯„å­˜å™¨ï¼ŒCSï¼ŒDSï¼ŒES å’Œ SSï¼Œåˆ†åˆ«ç”¨äºæŒ‡ä»¤ã€æ•°æ®ã€å…¶å®ƒå’Œå †æ ˆã€‚</p>
<p>â€‹    FSã€GS æ˜¯ä» 80386 å¼€å§‹å¢åŠ çš„ä¸¤ä¸ªè¾…åŠ©æ®µå¯„å­˜å™¨ï¼Œæ²¡æœ‰å…¨ç§°ï¼Œå–åå°±æ˜¯æŒ‰å­—æ¯åºæ’åœ¨ CSã€DSã€ES ä¹‹åçš„ã€‚ </p>
<h4 id="æ³¨è§£p5-2"><a href="#æ³¨è§£p5-2" class="headerlink" title="æ³¨è§£p5_2"></a>æ³¨è§£p5_2</h4><p>char ç±»å‹å æœ‰1ä¸ªå­—èŠ‚(8bits)çš„ç©ºé—´, ä»£ç ä¸­å¯¹äºæ¯ä¸ªå­—ç¬¦, å–åå››ä½ä»£ç , å¹¶åŠ ä¸Š0x4024b0å¾—åˆ°æ˜ å°„å­—ç¬¦çš„åœ°å€, å¹¶å°†å¾—åˆ°çš„æ˜ å°„å­—ç¬¦å­˜å…¥æ ˆä¸­çš„å¯¹åº”ä½ç½®.ä¾‹å¦‚å½“å­—ç¬¦ä¸²çš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸ºOæ—¶, ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œ:</p>
<blockquote>
<p>å­—ç¬¦<code>O</code>å¯¹åº”çš„ASCAIIç ä¸º <code>0x4f</code></p>
<p>å–åå››ä½ä»£ç  <code>0xf</code></p>
<p>å¾—åˆ°æ˜ å°„å­—ç¬¦çš„åœ°å€ <code>0x4024bf</code></p>
<p>è®¿é—®è¯¥åœ°å€, å¾—åˆ°æ˜ å°„å­—ç¬¦<code>l</code> , å¹¶å­˜å…¥æ ˆ11å¤„ (11æ˜¯ç¬¬äºŒä¸ªå­—ç¬¦å¯¹åº”æ ˆä¸­çš„ä½ç½®)</p>
</blockquote>
<h4 id="æ³¨è§£p5-3"><a href="#æ³¨è§£p5-3" class="headerlink" title="æ³¨è§£p5_3"></a>æ³¨è§£p5_3</h4><p><strong><code>0x4024b0</code>é™„è¿‘å­˜å‚¨çš„å­—ç¬¦</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print (char) *(0x4024b0+0x0)</span><br><span class="line">$1 &#x3D; 109 &#39;m&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x1)</span><br><span class="line">$2 &#x3D; 97 &#39;a&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x2)</span><br><span class="line">$3 &#x3D; 100 &#39;d&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x3)</span><br><span class="line">$4 &#x3D; 117 &#39;u&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x4)</span><br><span class="line">$5 &#x3D; 105 &#39;i&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x5)</span><br><span class="line">$6 &#x3D; 101 &#39;e&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x6)</span><br><span class="line">$7 &#x3D; 114 &#39;r&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x7)</span><br><span class="line">$8 &#x3D; 115 &#39;s&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x8)</span><br><span class="line">$9 &#x3D; 110 &#39;n&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0x9)</span><br><span class="line">$10 &#x3D; 102 &#39;f&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xa)</span><br><span class="line">$11 &#x3D; 111 &#39;o&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xb)</span><br><span class="line">$12 &#x3D; 116 &#39;t&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xc)</span><br><span class="line">$13 &#x3D; 118 &#39;v&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xd)</span><br><span class="line">$14 &#x3D; 98 &#39;b&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xe)</span><br><span class="line">$15 &#x3D; 121 &#39;y&#39;</span><br><span class="line">(gdb) print (char) *(0x4024b0+0xf)</span><br><span class="line">$16 &#x3D; 108 &#39;l&#39;</span><br></pre></td></tr></table></figure>
<p><strong><code>0x40245e</code> å‚¨å­˜çš„å­—ç¬¦</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print (char*) 0x40245e</span><br><span class="line">$17 &#x3D; 0x40245e &quot;flyers&quot;</span><br></pre></td></tr></table></figure>
<p><strong>å¶ç„¶å‘ç°çš„ä¸€ä¸ªå½©è›‹</strong></p>
<p>å›åˆ° <code>0x4024b0</code>é™„è¿‘, ç†è®ºä¸Šå¯èƒ½æ˜ å°„åˆ°çš„å­—ç¬¦åœ°å€åº”è¯¥æ˜¯ä» <code>0x4024b0</code>~<code>0x4024bf</code> , ä½†å®é™…ä¸Š<code>0x4024c0</code>ä»¥åŠåé¢æœ‰å­—ç¬¦å¯ä»¥å–åˆ°, å¦‚æœè°ƒç”¨çš„ä¸æ˜¯æŸ¥çœ‹åœ°å€å¯¹åº”çš„å­—ç¬¦, è€Œæ˜¯å­—ç¬¦ä¸²çš„è¯, ä¼šå‘ç°ä¸‹é¢ä¸€æ®µè¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print (char*) 0x4024b0</span><br><span class="line">$18 &#x3D; 0x4024b0 &lt;array&gt; &quot;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&quot;</span><br></pre></td></tr></table></figure>
<p>å‰16ä¸ªå­—ç¬¦å°±æ˜¯æˆ‘ä»¬ç”¨äºè§£é¢˜çš„å­—ç¬¦, åé¢å±…ç„¶è¿˜æœ‰ä¸€å¥æ¥è‡ªæ•™æˆçš„åæ§½LOLğŸ˜‚</p>
<h3 id="Phase-6"><a href="#Phase-6" class="headerlink" title="Phase_6"></a>Phase_6</h3><ul>
<li>è¾“å…¥: *input</li>
<li>åŠŸèƒ½: è¾“å…¥å…­ä¸ªæ•°å­—</li>
<li>è°ƒç”¨: read_six_numbers</li>
<li>è¿”å›: 0</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">%rdi &amp;input</span><br><span class="line">Dump of assembler code for function phase_6:</span><br><span class="line">   0x00000000004010f4 &lt;+0&gt;:	push   %r14</span><br><span class="line">   0x00000000004010f6 &lt;+2&gt;:	push   %r13</span><br><span class="line">   0x00000000004010f8 &lt;+4&gt;:	push   %r12</span><br><span class="line">   0x00000000004010fa &lt;+6&gt;:	push   %rbp</span><br><span class="line">   0x00000000004010fb &lt;+7&gt;:	push   %rbx</span><br><span class="line">   0x00000000004010fc &lt;+8&gt;:	sub    $0x50,%rsp</span><br><span class="line">   0x0000000000401100 &lt;+12&gt;:	mov    %rsp,%r13</span><br><span class="line">   0x0000000000401103 &lt;+15&gt;:	mov    %rsp,%rsi</span><br><span class="line">   0x0000000000401106 &lt;+18&gt;:	callq  0x40145c &lt;read_six_numbers&gt;  &#x2F;&#x2F;è¯»å…¥6ä¸ªæ•°å­—</span><br><span class="line">   0x000000000040110b &lt;+23&gt;:	mov    %rsp,%r14</span><br><span class="line">   0x000000000040110e &lt;+26&gt;:	mov    $0x0,%r12d   </span><br><span class="line">   0x0000000000401114 &lt;+32&gt;:	mov    %r13,%rbp                &#x2F;&#x2F;rbp&#x3D;r13 å¤–å¾ªç¯1èµ·å§‹</span><br><span class="line">   0x0000000000401117 &lt;+35&gt;:	mov    0x0(%r13),%eax              </span><br><span class="line">   0x000000000040111b &lt;+39&gt;:	sub    $0x1,%eax                &#x2F;&#x2F;ax&#x3D;(r13)-1</span><br><span class="line">   0x000000000040111e &lt;+42&gt;:	cmp    $0x5,%eax                &#x2F;&#x2F;axä¸5æ¯”è¾ƒ</span><br><span class="line">   0x0000000000401121 &lt;+45&gt;:	jbe    0x401128 &lt;phase_6+52&gt;    &#x2F;&#x2F;ax&gt;5 ç‚¸</span><br><span class="line">   0x0000000000401123 &lt;+47&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000401128 &lt;+52&gt;:	add    $0x1,%r12d               &#x2F;&#x2F;r12++  r12ä¸ºå¤–å¾ªç¯ç´¢å¼•</span><br><span class="line">   0x000000000040112c &lt;+56&gt;:	cmp    $0x6,%r12d               &#x2F;&#x2F;æ¯”è¾ƒr12ä¸6</span><br><span class="line">   0x0000000000401130 &lt;+60&gt;:	je     0x401153 &lt;phase_6+95&gt;    &#x2F;&#x2F;å¾ªç¯6æ¬¡ ç»“æŸè½¬95(å¤–å¾ªç¯ 1)</span><br><span class="line">   0x0000000000401132 &lt;+62&gt;:	mov    %r12d,%ebx</span><br><span class="line">   0x0000000000401135 &lt;+65&gt;:	movslq %ebx,%rax                &#x2F;&#x2F;é‡Œå¾ªç¯èµ·å§‹</span><br><span class="line">   0x0000000000401138 &lt;+68&gt;:	mov    (%rsp,%rax,4),%eax       &#x2F;&#x2F;ax &#x3D; æ ˆ[r12]</span><br><span class="line">   0x000000000040113b &lt;+71&gt;:	cmp    %eax,0x0(%rbp)           &#x2F;&#x2F;æ¯”è¾ƒ(r13)ä¸ax</span><br><span class="line">   0x000000000040113e &lt;+74&gt;:	jne    0x401145 &lt;phase_6+81&gt;    &#x2F;&#x2F;ä¸ç­‰äº è½¬81 ç­‰äº ç‚¸</span><br><span class="line">   0x0000000000401140 &lt;+76&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000401145 &lt;+81&gt;:	add    $0x1,%ebx                &#x2F;&#x2F;bx++ bxä¸ºé‡Œå¾ªç¯ç´¢å¼•</span><br><span class="line">   0x0000000000401148 &lt;+84&gt;:	cmp    $0x5,%ebx                </span><br><span class="line">   0x000000000040114b &lt;+87&gt;:	jle    0x401135 &lt;phase_6+65&gt;    &#x2F;&#x2F;è‹¥bx&lt;&#x3D;5, å³æ•°2~æ•°5 å¾ªç¯65 (é‡Œå¾ªç¯ 2)</span><br><span class="line">   0x000000000040114d &lt;+89&gt;:	add    $0x4,%r13                &#x2F;&#x2F;ç°åœ¨æ•°6,r13&#x3D;ä¸‹ä¸€ä¸ªæ•°å­—æ ˆåœ°å€</span><br><span class="line">   0x0000000000401151 &lt;+93&gt;:	jmp    0x401114 &lt;phase_6+32&gt;    &#x2F;&#x2F;è½¬32(å¤–å¾ªç¯) </span><br><span class="line">   &#x2F;&#x2F;å¾ªç¯12: å¤–å¾ªç¯ä¿è¯æ¯ä¸ªæ•°å­—å‡âˆˆ[1,6] , é‡Œå¾ªç¯ä¿è¯æ•°å­—å„ä¸ç›¸åŒ</span><br><span class="line">   &#x2F;&#x2F;æ–¹ä¾¿èµ·è§, ç§°è¾“å…¥çš„6ä¸ªæ•°å­—ä¸ºa[i],iâˆˆ[0,5]</span><br><span class="line">   0x0000000000401153 &lt;+95&gt;:	lea    0x18(%rsp),%rsi          &#x2F;&#x2F;rsi&#x3D;æ ˆ+24 (æ ˆ0~20å­˜å‚¨æ•°1-6)</span><br><span class="line">   0x0000000000401158 &lt;+100&gt;:	mov    %r14,%rax                &#x2F;&#x2F;ax&#x3D;æ ˆ0åœ°å€</span><br><span class="line">   0x000000000040115b &lt;+103&gt;:	mov    $0x7,%ecx                &#x2F;&#x2F;cx&#x3D;7</span><br><span class="line">   0x0000000000401160 &lt;+108&gt;:	mov    %ecx,%edx                &#x2F;&#x2F;dx &#x3D; cx       å¾ªç¯3èµ·å§‹</span><br><span class="line">   0x0000000000401162 &lt;+110&gt;:	sub    (%rax),%edx              &#x2F;&#x2F;dx -&#x3D; *ax</span><br><span class="line">   0x0000000000401164 &lt;+112&gt;:	mov    %edx,(%rax)              &#x2F;&#x2F;*ax &#x3D; dx</span><br><span class="line">   0x0000000000401166 &lt;+114&gt;:	add    $0x4,%rax                &#x2F;&#x2F;axæŒ‡å‘ä¸‹ä¸€ä¸ªæ•°å­—  axä¸ºå¾ªç¯3ç´¢å¼•</span><br><span class="line">   0x000000000040116a &lt;+118&gt;:	cmp    %rsi,%rax                &#x2F;&#x2F;å¦‚æœax!&#x3D;æ ˆ+24</span><br><span class="line">   0x000000000040116d &lt;+121&gt;:	jne    0x401160 &lt;phase_6+108&gt;   &#x2F;&#x2F;è½¬108 å¾ªç¯3</span><br><span class="line">   0x000000000040116f &lt;+123&gt;:	mov    $0x0,%esi                &#x2F;&#x2F;si &#x3D; 0   </span><br><span class="line">   0x0000000000401174 &lt;+128&gt;:	jmp    0x401197 &lt;phase_6+163&gt;   &#x2F;&#x2F;è½¬163         å¾ªç¯3ç»“æŸ</span><br><span class="line">   &#x2F;&#x2F;å¾ªç¯3: ä½¿æ¯æ•°1-æ•°6ä¸åŸåœ°å¯¹7å–è¡¥(1-&gt;6,2-&gt;5) ç§°å–è¡¥åçš„æ•°ä¸ºb[i]&#x3D;7-a[i]</span><br><span class="line">   0x0000000000401176 &lt;+130&gt;:	mov    0x8(%rdx),%rdx           &#x2F;&#x2F;dx +&#x3D; 0x8</span><br><span class="line">   0x000000000040117a &lt;+134&gt;:	add    $0x1,%eax                &#x2F;&#x2F;ax++</span><br><span class="line">   0x000000000040117d &lt;+137&gt;:	cmp    %ecx,%eax                &#x2F;&#x2F;æ¯”è¾ƒæ•°è¡¥ä¸ax</span><br><span class="line">   0x000000000040117f &lt;+139&gt;:	jne    0x401176 &lt;phase_6+130&gt;   &#x2F;&#x2F;ä¸ç­‰ è½¬130</span><br><span class="line">   0x0000000000401181 &lt;+141&gt;:	jmp    0x401188 &lt;phase_6+148&gt;   &#x2F;&#x2F;ç­‰ è½¬148</span><br><span class="line">   0x0000000000401183 &lt;+143&gt;:	mov    $0x6032d0,%edx           &#x2F;&#x2F;dx &#x3D; 0x6032d0</span><br><span class="line">   0x0000000000401188 &lt;+148&gt;:	mov    %rdx,0x20(%rsp,%rsi,2)   &#x2F;&#x2F;(æ ˆ+2*si+32)&#x3D;dx</span><br><span class="line">   0x000000000040118d &lt;+153&gt;:	add    $0x4,%rsi                &#x2F;&#x2F;si+&#x3D;4         siä½œä¸ºå¾ªç¯4ç´¢å¼•</span><br><span class="line">   0x0000000000401191 &lt;+157&gt;:	cmp    $0x18,%rsi               &#x2F;&#x2F;è‹¥si&#x3D;&#x3D;24 </span><br><span class="line">   0x0000000000401195 &lt;+161&gt;:	je     0x4011ab &lt;phase_6+183&gt;   &#x2F;&#x2F;è½¬183         å¾ªç¯4ç»“æŸ</span><br><span class="line">   0x0000000000401197 &lt;+163&gt;:	mov    (%rsp,%rsi,1),%ecx       &#x2F;&#x2F;cx &#x3D; (æ ˆ+si)  å¾ªç¯4èµ·å§‹ </span><br><span class="line">   0x000000000040119a &lt;+166&gt;:	cmp    $0x1,%ecx                &#x2F;&#x2F;cx ä¸ 1æ¯”è¾ƒ</span><br><span class="line">   0x000000000040119d &lt;+169&gt;:	jle    0x401183 &lt;phase_6+143&gt;   &#x2F;&#x2F;è‹¥cx&lt;&#x3D;1 è½¬143 </span><br><span class="line">   0x000000000040119f &lt;+171&gt;:	mov    $0x1,%eax                &#x2F;&#x2F;ax &#x3D; 1</span><br><span class="line">   0x00000000004011a4 &lt;+176&gt;:	mov    $0x6032d0,%edx           &#x2F;&#x2F;dx &#x3D; 0x6032d0</span><br><span class="line">   0x00000000004011a9 &lt;+181&gt;:	jmp    0x401176 &lt;phase_6+130&gt;   &#x2F;&#x2F;è½¬130</span><br><span class="line">   &#x2F;&#x2F;å¾ªç¯4: ä½¿(æ ˆ32+8*(i-1))&#x3D;0x6032d0+b[i]*16 </span><br><span class="line">   &#x2F;&#x2F;ç§°åœ°å€ æ ˆ32+8*(i-1) ä¸ºd0~d5</span><br><span class="line">   &#x2F;&#x2F;ç§°å…¶ä¸­å‚¨å­˜çš„æ•°æ®,å³0x6032d0+b[i]*16,ä¸ºk0~k5</span><br><span class="line">   0x00000000004011ab &lt;+183&gt;:	mov    0x20(%rsp),%rbx          &#x2F;&#x2F;bx &#x3D; k[0]</span><br><span class="line">   0x00000000004011b0 &lt;+188&gt;:	lea    0x28(%rsp),%rax          &#x2F;&#x2F;ax &#x3D; &amp;k[1] &#x3D; d[0]</span><br><span class="line">   0x00000000004011b5 &lt;+193&gt;:	lea    0x50(%rsp),%rsi          &#x2F;&#x2F;si &#x3D; &amp;æ ˆ+0x50 &#x3D; d[6]</span><br><span class="line">   0x00000000004011ba &lt;+198&gt;:	mov    %rbx,%rcx                &#x2F;&#x2F;cx &#x3D; bx</span><br><span class="line">   0x00000000004011bd &lt;+201&gt;:	mov    (%rax),%rdx              &#x2F;&#x2F;dx &#x3D; (ax)  å¾ªç¯5èµ·å§‹</span><br><span class="line">   0x00000000004011c0 &lt;+204&gt;:	mov    %rdx,0x8(%rcx)           &#x2F;&#x2F;cx+8å‚¨å­˜dx ä¾‹å¦‚ k0+8å‚¨å­˜k1 k4+8å‚¨å­˜k5</span><br><span class="line">   0x00000000004011c4 &lt;+208&gt;:	add    $0x8,%rax                &#x2F;&#x2F;ax &#x3D; &amp;(ä¸‹ä¸€ä¸ª)</span><br><span class="line">   0x00000000004011c8 &lt;+212&gt;:	cmp    %rsi,%rax</span><br><span class="line">   0x00000000004011cb &lt;+215&gt;:	je     0x4011d2 &lt;phase_6+222&gt;   &#x2F;&#x2F;å¾ªç¯5ç»“æŸ è½¬222</span><br><span class="line">   0x00000000004011cd &lt;+217&gt;:	mov    %rdx,%rcx                &#x2F;&#x2F;rcx &#x3D; k5  </span><br><span class="line">   0x00000000004011d0 &lt;+220&gt;:	jmp    0x4011bd &lt;phase_6+201&gt;   &#x2F;&#x2F;è½¬201</span><br><span class="line">   &#x2F;&#x2F;å¾ªç¯5:  k0+8å‚¨å­˜k1 v4+8å‚¨å­˜k5</span><br><span class="line">   &#x2F;&#x2F;è‹¥å°†k[i]ä½œä¸ºåœ°å€,æŒ‡å‘æ•°å­—v[i]</span><br><span class="line">   0x00000000004011d2 &lt;+222&gt;:	movq   $0x0,0x8(%rdx)           &#x2F;&#x2F;k5+8å‚¨å­˜0</span><br><span class="line">   0x00000000004011da &lt;+230&gt;:	mov    $0x5,%ebp                &#x2F;&#x2F;bp&#x3D;5  ä½œä¸ºç´¢å¼•</span><br><span class="line">   0x00000000004011df &lt;+235&gt;:	mov    0x8(%rbx),%rax           &#x2F;&#x2F;ax &#x3D; (k[i]+8) &#x3D; k[i+1]   å¾ªç¯6èµ·å§‹</span><br><span class="line">   0x00000000004011e3 &lt;+239&gt;:	mov    (%rax),%eax              &#x2F;&#x2F;ax &#x3D; (k[i+1]) &#x3D; v[i+1]</span><br><span class="line">   0x00000000004011e5 &lt;+241&gt;:	cmp    %eax,(%rbx)              &#x2F;&#x2F;æ¯”è¾ƒ(rbx) ä¸ ax , bx&#x3D;k[i], (bx)&#x3D;v[i]</span><br><span class="line">   0x00000000004011e7 &lt;+243&gt;:	jge    0x4011ee &lt;phase_6+250&gt;   &#x2F;&#x2F;è‹¥(rbx)&gt;ax è½¬ 250</span><br><span class="line">   0x00000000004011e9 &lt;+245&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x00000000004011ee &lt;+250&gt;:	mov    0x8(%rbx),%rbx           &#x2F;&#x2F;bx+&#x3D;8</span><br><span class="line">   0x00000000004011f2 &lt;+254&gt;:	sub    $0x1,%ebp                &#x2F;&#x2F;bp-1  </span><br><span class="line">   0x00000000004011f5 &lt;+257&gt;:	jne    0x4011df &lt;phase_6+235&gt;   &#x2F;&#x2F;å¾ªç¯6</span><br><span class="line">   &#x2F;&#x2F;å¾ªç¯6: ä¿è¯v[i]&gt;v[i+1]</span><br><span class="line">   0x00000000004011f7 &lt;+259&gt;:	add    $0x50,%rsp               </span><br><span class="line">   0x00000000004011fb &lt;+263&gt;:	pop    %rbx</span><br><span class="line">   0x00000000004011fc &lt;+264&gt;:	pop    %rbp</span><br><span class="line">   0x00000000004011fd &lt;+265&gt;:	pop    %r12</span><br><span class="line">   0x00000000004011ff &lt;+267&gt;:	pop    %r13</span><br><span class="line">   0x0000000000401201 &lt;+269&gt;:	pop    %r14</span><br><span class="line">   0x0000000000401203 &lt;+271&gt;:	retq</span><br></pre></td></tr></table></figure>
<p>æ³¨: </p>
<ul>
<li>ä»£ç ä¸­ä¸€å…±æ¶‰åŠåˆ°6ä¸ªå¾ªç¯ä½“</li>
<li>æˆ‘ä»¬ç§°è¾“å…¥çš„åŸæ•°ä¸ºa[i], iâˆˆ[0,5]</li>
<li>å¾ªç¯1, å¾ªç¯2 ä¸ºä¸€ä¸ªäºŒé‡åµŒå¥—å¾ªç¯, å¾ªç¯1ä¸ºå¤–å¾ªç¯, å¾ªç¯2ä¸ºé‡Œå¾ªç¯</li>
<li>å¾ªç¯1ä¿è¯è¾“å…¥çš„æ¯ä¸ªæ•°å­—éƒ½å±äº[1,6]</li>
<li>å¾ªç¯2ä¿è¯è¾“å…¥çš„æ¯ä¸ªæ•°å­—ä¸¤ä¸¤ç›¸å¼‚</li>
<li>å¾ªç¯3 ä½¿æ¯æ•°1-æ•°6ä¸åŸåœ°å¯¹7å–è¡¥(1-&gt;6,2-&gt;5) ç§°å–è¡¥åçš„æ•°ä¸ºb[i]=7-a[i]</li>
<li>å¾ªç¯4: <ul>
<li>å¯¹äºæ¯ä¸ªi, ç§°åœ°å€ $æ ˆ32+8\times(i-1)$ ä¸ºd[0]~d[5] </li>
<li>å¯¹äºæ¯ä¸ªi, ç§°æ•°æ® $0x6032d0+b[i]\times 16$ ä¸ºk[0]-k[5]</li>
<li>åœ¨ d[i] ä¸­å‚¨å­˜ k[i]</li>
<li>k[i] ä¹Ÿå¯ä»¥ä½œä¸ºåœ°å€, å¯¹åº”æ•°æ®æˆä¸ºv[i]</li>
</ul>
</li>
<li>å¾ªç¯5:åœ¨<code>k[i] + 8</code> å¤„å‚¨å­˜ <code>k[i+1],</code> è¿™ä¸€æ­¥æ˜¯ä¸ºäº†åç»­æ“ä½œçš„æ–¹ä¾¿</li>
<li>å¾ªç¯6: å¿…é¡»ä¿è¯<code>v[i]&gt;v[i+1]</code></li>
</ul>
<h4 id="æ³¨è§£p6-1"><a href="#æ³¨è§£p6-1" class="headerlink" title="æ³¨è§£p6_1"></a>æ³¨è§£p6_1</h4><p>0x6032d0é™„è¿‘å‚¨å­˜çš„å€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print *(int*) (0x6032d0+16*0)</span><br><span class="line">$83 &#x3D; 332</span><br><span class="line"></span><br><span class="line">(gdb) print *(int*) (0x6032d0+16*1)</span><br><span class="line">$84 &#x3D; 168</span><br><span class="line"></span><br><span class="line">(gdb) print *(int*) (0x6032d0+16*2)</span><br><span class="line">$85 &#x3D; 924</span><br><span class="line"></span><br><span class="line">(gdb) print *(int*) (0x6032d0+16*3)</span><br><span class="line">$86 &#x3D; 691</span><br><span class="line"></span><br><span class="line">(gdb) print *(int*) (0x6032d0+16*4)</span><br><span class="line">$88 &#x3D; 477</span><br><span class="line"></span><br><span class="line">(gdb) print *(int*) (0x6032d0+16*5)</span><br><span class="line">$89 &#x3D; 443</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨è§£p6-2"><a href="#æ³¨è§£p6-2" class="headerlink" title="æ³¨è§£p6_2"></a>æ³¨è§£p6_2</h4><p>å› æ­¤, è‹¥ä½¿å¾—v[0]~v[5]ä¾æ¬¡ä¸º924,691,477,443,332,168</p>
<p>åˆ™b[i]-1 åº”ä¾æ¬¡ä¸º: 2,3,4,5,0,1</p>
<p>åŸå€¼a[i] åº”ä¾æ¬¡ä¸º: 4,3,2,1,6,5</p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ç‚¸å¼¹å®éªŒå®¤ä»6æœˆ25æ—¥å¼€å§‹, è‡³7æœˆ1æ—¥å‡Œæ™¨ä¸¤ç‚¹å®Œæˆ. </p>
<p>æŒæ¡äº†gdbè°ƒè¯•æ–¹æ³•, å’Œç®€å•æ±‡ç¼–è¯­è¨€çš„é˜…è¯»èƒ½åŠ›, å¯¹å…¶ä¸­çš„æ•°æ®å‚¨å­˜, æ•°æ®åŸºæœ¬è®¡ç®—, å‡½æ•°è°ƒç”¨, åˆ†æ”¯ä¸å¾ªç¯çš„ä½“ç°, æ ˆä¸å†…å­˜çš„åˆ†é…ç­‰å†…å®¹æœ‰äº†åŸºæœ¬äº†è§£. </p>
<p>åæ¥åœ¨å‚è€ƒå…¶ä»–åšå®¢çš„ç¬”è®°æ—¶å‘ç°è¿˜æœ‰ä¸€ä¸ªéšè—ç‚¸å¼¹. å…ˆæ”¾ç½®å§, æœ‰æ—¶é—´ä¼šæ¥å¡«å‘.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"># å­¦ä¹ ç¬”è®°</a>
              <a href="/tags/CSAPP/" rel="tag"># CSAPP</a>
              <a href="/tags/Lab/" rel="tag"># Lab</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/28/%E6%97%B6%E4%B8%8E%E5%85%89W_202006-4/" rel="prev" title="æ—¶ä¸å…‰W_202006-4">
      <i class="fa fa-chevron-left"></i> æ—¶ä¸å…‰W_202006-4
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81MDQyOS8yNjkxNg"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Catalog"><span class="nav-number">1.</span> <span class="nav-text">Catalog</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GDB"><span class="nav-number">2.</span> <span class="nav-text">GDB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Breakpoints"><span class="nav-number">2.1.</span> <span class="nav-text">Breakpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Execution"><span class="nav-number">2.2.</span> <span class="nav-text">Execution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Print"><span class="nav-number">2.3.</span> <span class="nav-text">Print</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Info"><span class="nav-number">2.4.</span> <span class="nav-text">Info</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bombs"><span class="nav-number">3.</span> <span class="nav-text">Bombs</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb1"><span class="nav-number">3.1.</span> <span class="nav-text">Bomb1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb2"><span class="nav-number">3.2.</span> <span class="nav-text">Bomb2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb3"><span class="nav-number">3.3.</span> <span class="nav-text">Bomb3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb4"><span class="nav-number">3.4.</span> <span class="nav-text">Bomb4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb-5"><span class="nav-number">3.5.</span> <span class="nav-text">Bomb 5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bomb-6"><span class="nav-number">3.6.</span> <span class="nav-text">Bomb 6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Functions"><span class="nav-number">4.</span> <span class="nav-text">Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Main"><span class="nav-number">4.1.</span> <span class="nav-text">Main()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-1"><span class="nav-number">4.2.</span> <span class="nav-text">Phase_1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#strings-not-equal"><span class="nav-number">4.3.</span> <span class="nav-text">strings_not_equal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string-length"><span class="nav-number">4.4.</span> <span class="nav-text">string_length</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-2"><span class="nav-number">4.5.</span> <span class="nav-text">Phase_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#read-six-numbers"><span class="nav-number">4.6.</span> <span class="nav-text">read_six_numbers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-3"><span class="nav-number">4.7.</span> <span class="nav-text">Phase_3</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p3-1"><span class="nav-number">4.7.1.</span> <span class="nav-text">æ³¨è§£p3_1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p3-2"><span class="nav-number">4.7.2.</span> <span class="nav-text">æ³¨è§£p3_2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-4"><span class="nav-number">4.8.</span> <span class="nav-text">Phase_4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#func4"><span class="nav-number">4.9.</span> <span class="nav-text">func4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-5"><span class="nav-number">4.10.</span> <span class="nav-text">Phase_5</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p5-1"><span class="nav-number">4.10.1.</span> <span class="nav-text">æ³¨è§£p5_1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p5-2"><span class="nav-number">4.10.2.</span> <span class="nav-text">æ³¨è§£p5_2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p5-3"><span class="nav-number">4.10.3.</span> <span class="nav-text">æ³¨è§£p5_3</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Phase-6"><span class="nav-number">4.11.</span> <span class="nav-text">Phase_6</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p6-1"><span class="nav-number">4.11.1.</span> <span class="nav-text">æ³¨è§£p6_1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£p6-2"><span class="nav-number">4.11.2.</span> <span class="nav-text">æ³¨è§£p6_2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åè®°"><span class="nav-number">5.</span> <span class="nav-text">åè®°</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LUY"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">LUY</p>
  <div class="site-description" itemprop="description">å˜¿, è¿™é‡Œæ˜¯ç§äººç©ºé—´!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/luy-0" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;luy-0" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LUY</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">46k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:16</span>
</div>
<!--
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>
-->
<div>
<span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("05/31/2020 00:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+dnum+" å¤© ";
        document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
    }
setInterval("createtime()",250);
</script>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
